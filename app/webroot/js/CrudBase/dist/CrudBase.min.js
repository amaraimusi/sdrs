"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var AjaxLoginWithCake=function(){function t(e){_classCallCheck(this,t),this.param=this._setParamIfEmpty(e)}return _createClass(t,[{key:"_setParamIfEmpty",value:function(e){return null==e&&(e={}),null==e.btn_type&&(e.btn_type=1),null==e.login_check_url&&(e.login_check_url="ajax_login_with_cake/login_check"),null==e.login_url&&(e.login_url="ajax_login_with_cake/login_rap"),null==e.logout_url&&(e.logout_url="users/logout"),this._isEmpty(e.callback)&&(e.callback=null),this._isEmpty(e.form_slt)&&(e.form_slt="#ajax_login_with_cake"),e}},{key:"_margeParam",value:function(e){return this.param=Object.assign({},this.param,e),this.param}},{key:"loginCheckEx",value:function(e){this._getUrlQuery();this.loginCheck(e)}},{key:"loginCheck",value:function(i){var n=this;i=this._margeParam(i);var e=JSON.stringify({dummy:1});$.ajax({type:"POST",url:i.login_check_url,data:"key1="+e,cache:!1,dataType:"text"}).done(function(t,e){try{var a=jQuery.parseJSON(t)}catch(e){throw alert("エラー"+t),new Error(t)}n._showBtns(a),null!=i.callback&&callBack(a.auth_flg)}).fail(function(e,t,a){jQuery("#err").html(e.responseText),alert(t)})}},{key:"_showBtns",value:function(e){var t=this.param.form_slt,a=jQuery(t);if(1==e.auth_flg){var i=this._getLogoutBtnHtml();a.html(i)}else{var n=this._getLoginBtnHtml();a.html(n)}}},{key:"_getLogoutBtnHtml",value:function(){var e=this.param.logout_url;return 1==this.param.btn_type?"<span class='text-success'>認証中です </span><a href='"+e+"' id='logout_btn' class='btn btn-default btn-xs'>ログアウト</a>":"<a href='"+e+"' id='logout_btn'>ログアウト</a>"}},{key:"_getLoginBtnHtml",value:function(){var e=this.param.login_url;return 1==this.param.btn_type?"<a id='login_btn' href='"+e+"' class='btn btn-primary' >ログイン</a>":"<a id='login_btn' href='"+e+"' >ログイン</a>"}},{key:"_getUrlQuery",value:function(){if(""==(e=window.location.search)||null==e)return{};for(var e=e.substring(1,e.length),t=e.split("&"),a={},i=0;i<t.length;i++){var n=t[i].split("=");a[n[0]]=n[1]}return a}},{key:"_isEmpty",value:function(e){return""==e||null==e||0==e}},{key:"_isSet",value:function(e){return""!=e&&null!=e&&0!=e}}]),t}(),CalendarViewK=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"create",value:function(e,t,a){e=this._shapingDateInData(e,t);var i=this._getBaseMonthStart(e,t);if(null!=i){var n=this._getMonthEndDate(i),r=this._createCalendarDataFormat(i,n),l=this._aggByDateField(e,t);r=this._mappingToCalData(r,l),r=this._weekStructConv(r),null==a&&(a=this._callback);var s=this._buildCalendarViewHtml(r,a,i);jQuery("#calendar_view_k").html(s)}else console.log("カレンダービュー：データ中に日付がありません。")}},{key:"_callback",value:function(e,t){var a="";if(null!=e.ents){var i=e.ents;for(var n in i){var r=i[n],l=t._getNameField(r);a+="<div>"+t._xss_sanitize(r[l])+"</div>"}}return a="<div style='width:120px;height:80px'>"+a+"</div>"}},{key:"_getNameField",value:function(e){if(null==this.name_field)for(var t in this.name_field="id",e)0<=t.indexOf("name")&&(this.name_field=t);return this.name_field}},{key:"_xss_sanitize",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(e){if("object"!=_typeof(e))return"string"==typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;"):e;for(var t in e)e[t]=_xss_sanitize(e[t]);return e})},{key:"_buildCalendarViewHtml",value:function(e,t,a){var i=new Date(a),n="<table class='calendar_view_k'><caption>"+(i.getFullYear()+"-"+(i.getMonth()+1))+"</caption><thead><tr>",r=[{code:"sun",wamei:"日"},{code:"mon",wamei:"月"},{code:"tue",wamei:"火"},{code:"wed",wamei:"水"},{code:"thu",wamei:"木"},{code:"fri",wamei:"金"},{code:"sat",wamei:"土"}];for(var l in r){var s=r[l].wamei;n+="<th class='"+("cvk_"+(c=r[l].code))+"'>"+s+"</th>"}for(var l in n+="</tr></thead><tbody>",e){var o=e[l];for(var u in n+="<tr>",o){var c,f=o[u],d=new Date(u),h=d.getDate(),_="cvk_"+(c=r[d.getDay()].code);0==f.cur_month_flg&&(_="cvk_out_this_month"),n+="<td><div class='cvk_cell'><div class='cvk_cell_div1 "+_+"'>"+h+"</div><div class='cvk_cell_div2'> "+c+" </div><div class='cvk_cell_div3'>"+t(f,this)+"</div></div></td>"}n+="</tr>"}return n+="</tbody></table>"}},{key:"_weekStructConv",value:function(e){var t=[],a=0,i=0;for(var n in e){var r=e[n];if(null==t[a]){if(4<=a&&0==r.cur_month_flg)return t;t[a]={}}t[a][n]=r,7==++i&&(a++,i=0)}return t}},{key:"_mappingToCalData",value:function(e,t){for(var a in e)null!=t[a]&&(e[a].ents=t[a]);return e}},{key:"_createCalendarDataFormat",value:function(e,t){var a=new Date(e),i=a.getFullYear(),n=a.getMonth(),r=a.getDay(),l=new Date(e);l.setDate(l.getDate()-r);for(var s=this._convDateToYMD(l),o={},u=new Date(s),c=0;c<42;c++){var f=0;u.getFullYear()==i&&u.getMonth()==n&&(f=1);var d=this._convDateToYMD(u);o[d]={index:c,date:d,cur_month_flg:f},u.setDate(u.getDate()+1)}return o}},{key:"_shapingDateInData",value:function(e,t){for(var a in e){var i=e[a];i[t]=this._shapingDate(i[t])}return e}},{key:"_getBaseMonthStart",value:function(e,t){for(var a in e){var i=e[a];if(null!=i[t]){var n=i[t];return n=this._getMonthStartDate(n)}}return null}},{key:"_getMonthStartDate",value:function(e){return null==e?null:("string"==typeof e&&(e=new Date(e)),e.getFullYear()+"-"+(e.getMonth()+1)+"-1")}},{key:"_getMonthEndDate",value:function(e){if(null==e)return null;"string"==typeof e&&(e=new Date(e));var t=new Date(e.getFullYear(),e.getMonth()+1,0);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}},{key:"_aggByDateField",value:function(e,t){var a={};for(var i in e){var n=e[i],r=n[t];null!=r&&(null==a[r]&&(a[r]=[]),a[r].push(n))}return a}},{key:"_shapingDate",value:function(e){return null==e?null:("string"==typeof e&&(e=new Date(e)),e=this._convDateToYMD(e))}},{key:"_convDateToYMD",value:function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}}]),e}(),CbBtnSizeChanger=function(){function n(e,t){_classCallCheck(this,n),this.saveKeys=["cnfData"],this.ls_key="CbBtnSizeChanger",this.param=this._setParamIfEmpty(e);t=this._initCnfData(this.param,t);var a=this._createCnfFormHtml(t),i=jQuery(this.param.main_slt);i.html(a),this._setCheckEvent(i,t),this._setSubEvents(i),1==this.param.save_flg&&this._changeSizeAll(t),this.mainForm=i,this.cnfData=t}return _createClass(n,[{key:"_setParamIfEmpty",value:function(e){null==e&&(e={});var t=localStorage.getItem(this.ls_key);if(!this._empty(t)){var a=JSON.parse(t);if(a)for(var i in this.saveKeys){var n=this.saveKeys[i];e[n]=a[n]}}return null==e.cnfData&&(e.cnfData={}),null==e.main_slt&&(e.main_slt="#CbBtnSizeChanger"),null==e.radioData&&(e.radioData=[{value:"btn-xs",wamei:" 極小"},{value:"btn-sm",wamei:" 小　"},{value:"",wamei:" 普通"},{value:"btn-lg",wamei:" 大　"}]),null==e.save_flg&&(e.save_flg=1),e}},{key:"_initCnfData",value:function(e,t){var a=e.cnfData;for(var i in this._empty(t)&&(t={}),jQuery.extend(a,t),this._empty(a)&&(a=[{slt:".row_edit_btn",wamei:"編集ボタン",def_size:"btn-xs",size:"btn-xs"},{slt:".row_copy_btn",wamei:"複製ボタン",def_size:"btn-xs",size:"btn-xs"},{slt:".row_delete_btn",wamei:"削除ボタン",def_size:"btn-xs",size:"btn-xs"},{slt:".row_eliminate_btn",wamei:"抹消ボタン",def_size:"btn-xs",size:"btn-xs"},{slt:".row_exc_btn",wamei:"行入替ボタン(↑↓ボタン)",def_size:"btn-xs",size:"btn-xs"},{slt:".row_enabled_btn",wamei:"有効ボタン",def_size:"btn-xs",size:"btn-xs"}]),a){var n=a[i];n.code=this._getCodeFromSlt(n.slt)}return a}},{key:"_getCodeFromSlt",value:function(e){var t=e,a=t.charAt(0);return"."!=a&&"#"!=a||(t=t.substr(1)),t}},{key:"_createCnfFormHtml",value:function(e){var t="<div style='padding:10px;background-color:#8dbbf3;border-radius:5px;display:inline-block'><table class='tbl2'><tbody>";for(var a in e){var i=e[a];t+="<tr>",t+="<td>"+i.wamei+"</td>",t+="<td>"+this._createRadiosHtml(i)+"</td>",t+="</tr>"}return t+="</tbody></table>",t+="<input id='cbbsc_def_btn' type='button' value='初期に戻す' class='btn btn-default btn-xs' >",t+="<input id='cbbsc_close_btn' type='button' value='閉じる' class='btn btn-default btn-xs' >",t+="</div>"}},{key:"_createRadiosHtml",value:function(e){var t="",a=this.param.radioData;for(var i in a){var n=a[i],r="";n.value==e.size&&(r="checked"),t+="<label class='btn btn-primary btn-sm'><input type='radio' name='"+("cbbsc_r_"+e.code)+"' value='"+n.value+"' "+r+" >"+n.wamei+"</label>"}return t="<div class='btn-group' >"+t+"</div>"}},{key:"_setCheckEvent",value:function(e,t){var a=this;for(var i in t){var n="cbbsc_r_"+t[i].code;e.find("[name='"+n+"']").click(function(e){a._checkEvent(e)})}}},{key:"_checkEvent",value:function(e){var a=this,t=jQuery(e.target),i=t.attr("name"),n=t.val(),r=this._getCnfEntByName(i);r.size=n,jQuery(r.slt).each(function(e,t){a._changeSize(t,n)}),1==this.param.save_flg&&this._saveParam()}},{key:"_getCnfEntByName",value:function(e){var t=e.replace("cbbsc_r_","");for(var a in this.cnfData){var i=this.cnfData[a];if(i.code==t)return i}return null}},{key:"_changeSize",value:function(e,t){e=jQuery(e);var a=this.param.radioData;for(var i in a){var n=a[i].value;if(""!=n&&e.hasClass(n)){if(t==n)return;e.removeClass(n)}}""!=t&&e.addClass(t)}},{key:"_changeSizeAll",value:function(e){var a=this;for(var t in e){var i=e[t];jQuery(i.slt).each(function(e,t){a._changeSize(t,i.size)})}}},{key:"_setSubEvents",value:function(e){var t=this;e.find("#cbbsc_def_btn").click(function(e){t._returnToInit()}),e.find("#cbbsc_close_btn").click(function(e){t.mainForm.hide()})}},{key:"_returnToInit",value:function(){var e=this.cnfData;for(var t in e){var a=e[t];null==a.def_size&&(a.def_size="btn-xs"),a.size=a.def_size}this._changeSizeAll(e),this._setCnfDataToRadios(e),this._saveParam()}},{key:"_setCnfDataToRadios",value:function(e){for(var t in e){var a=e[t],i="cbbsc_r_"+a.code,n=this.mainForm.find("[name='"+i+"'][value='"+a.size+"']");n[0]&&n.prop("checked",!0)}}},{key:"_saveParam",value:function(){this.param.cnfData=this.cnfData;var e={};for(var t in this.saveKeys){var a=this.saveKeys[t];e[a]=this.param[a]}var i=JSON.stringify(e);localStorage.setItem(this.ls_key,i)}},{key:"_clear",value:function(){localStorage.removeItem(this.ls_key)}},{key:"_empty",value:function(e){return null==e||""==e||"0"==e||"object"==_typeof(e)&&0==Object.keys(e).length}}]),n}(),CbFileUploadComponent=function(){function a(e,t){_classCallCheck(this,a),this.fileUploadK=this._factoryFileUploadK(e,t),this.fuIds=e,this.fields=this._fueIdsToFields(e),this.dpData=this._makeDtData(this.fields),this.none_img_fp="img/icon/none.gif"}return _createClass(a,[{key:"_makeDtData",value:function(e){var t={},a=jQuery("#dp_tmpl").val(),i=["orig","mid","thum"];for(var n in i){var r=i[n];for(var l in e){var s,o=e[l];s=(s=(s=a).replace("%field",o)).replace("%dn",r),null==t[o]&&(t[o]={}),t[o][r]=s}}return t}},{key:"_fueIdsToFields",value:function(e){var t=[];for(var a in e){var i=e[a],n=this._fudIdToField(i);t.push(n)}return t=this._array_unique(t)}},{key:"_fudIdToField",value:function(e){var t=e;if(null==e)return t;if(e.length<3)return t;var a=t.slice(-2);if("_n"==a||"_e"==a)t=t.substr(0,t.length-2);return t}},{key:"_array_unique",value:function(e){return e.filter(function(e,t,a){return a.indexOf(e)===t})}},{key:"_factoryFileUploadK",value:function(e,t){var a=new FileUploadK({prog_slt:"#prog1",err_slt:"#err",valid_ext:"image",img_width:120,img_height:120});for(var i in e){var n=e[i];a.addEvent(n,t)}return a}},{key:"addEvent",value:function(e,t){return this.fileUploadK.addEvent(e,t)}},{key:"getFileParams",value:function(){return this.fileUploadK.getFileParams()}},{key:"uploadByAjax",value:function(e,t,a){return this.fileUploadK.uploadByAjax(e,t,a)}},{key:"getFileNames",value:function(e){return this.fileUploadK.getFileNames(e)}},{key:"setFilePaths",value:function(e,t,a,i){"string"==typeof t&&(t=[t]),null==a&&(a=[""]),"string"==typeof a&&(a=[a]);var n=this._fudIdToField(e),r=this.dpData[n].mid,l=[];for(var s in t){var o=t[s],u=a[s],c=this._joinDpFn(r,u,o);l.push(c)}return this.fileUploadK.setFilePaths(e,l,i),{fps:l}}},{key:"_joinDpFn",value:function(e,t,a){var i="";if(null==(e=(e=e.replace("%via_dp",t)).replace("//","/"))||""==e||0==e)return a;var n=e.slice(-1);if("/"==n||"\\"==n)i=e+a;else{var r="/";0<=e.lastIndexOf("\\")&&(r="\\"),i=e+r+a}return i}},{key:"setImageToTr",value:function(e,t,a){for(var i in this.fields){var n=this.fields[i],r=e.find("[for='"+n+"']");if(r[0]){var l=r.find("img");if(l[0]){var s=t[n];if(null==s||""==s)return l.attr("src",this.none_img_fp),void((u=r.find("a"))[0]&&u.attr("href",this.none_img_fp));var o="";if(null!=a[n])o=t[a[n]];var u,c=this.dpData[n].orig,f=this._joinDpFn(c,o,s),d=this.dpData[n].thum,h=this._joinDpFn(d,o,s),_=new Image;_.src=h,_.onload=function(){l.attr("src",h)},(u=r.find("a"))[0]&&u.attr("href",f)}}}}},{key:"setFilesToFd",value:function(e,t){var a=this.fileUploadK.box;for(var i in a){var n=this._getFieldInfoFromFuKey(i);if(n.form_type==t){var r=a[i].files;if(null!=r&&null!=r[0]){var l=a[i].fileData;if(null!=l[0])0==l[0].err_flg&&e.append(n.field,r[0])}}}return e}},{key:"_getFieldInfoFromFuKey",value:function(e){var t={fu_id:e,field:e,form_type:"none"};if(null==e||""==e)return t;if(e.length<3)return t;var a=e.slice(-2);if("_n"==a)t.form_type="new_inp",t.field=e.substr(0,e.length-2);else{if("_e"!=a)return t;t.form_type="edit",t.field=e.substr(0,e.length-2)}return t}}]),a}(),ClmShowHide=function(){var u=this;function c(e,t,a){var i=$("#"+u.props.chBoxsId);for(var n in u.defClmData){var r=u.defClmData[n].show_flg,l=i.find("[index="+n+"]");l[0]&&(1==r?(l.prop("checked",!0),u.clm_show_csh(e,n)):0==r&&(l.prop("checked",!1),u.clm_hide_csh(e,n)))}localStorage.removeItem(a+"_clmData")}function f(){var e=$("#"+u.props.chBoxsId),t=u.actClmData;for(var a in t){var i=e.find("[index="+a+"]");if(i[0]){var n=i.prop("checked");t[a].show_flg=1==n?1:0}}return t}this.props={},this.defClmData={},this.actClmData={},this.init=function(i,t,e,n){this.props.tblId=i,this.props.chBoxsId=t,null==(this.props.unique=n)&&(n=i);for(var a=[],r=0;r<e.length;r++){var l={clm_name:null,show_flg:e[r]};a[r]=l}r=0;$.each($("#"+i+" thead tr th"),function(){var e=$(this).html();try{a[r].clm_name=e}catch(e){return}r++});var s=localStorage.getItem(n+"_clmData"),o={};for(var r in o=""==s||null==s?$.extend(!0,{},a):JSON.parse(s),this.defClmData=a,this.actClmData=o,function(e,t,a){var i=$("#"+t);for(var n in i.empty(),a){var r=a[n];if(-1!=r.show_flg){var l="";1==r.show_flg&&(l="checked");var s="<div class='csh_cb_div'><input type='checkbox' class='csh_cb' "+l+" index='"+n+"' /><label>"+r.clm_name+"</label></div>";i.append(s)}}i.append("<div style='clear:both'></div>");var o="<div class='csh_func_btn'><input type='button' value='列表示を保存' id='"+e+"_save_btn' class='btn btn-primary btn-xs' /></div>";i.append(o);var u="<div class='csh_func_btn'><input type='button' value='すべてチェック' id='"+e+"_all_checked_btn' class='btn btn-primary btn-xs' /></div>";i.append(u);var c="<div class='csh_func_btn'><input type='button' value='初期に戻す' id='"+e+"_default_btn' class='btn btn-primary btn-xs' /></div>";i.append(c),i.append("<div id='csh_msg' class='csh_func_btn' style='display:none;color:#de5246'>列の表示状態を記憶しました。</div>")}(i,t,o),$(".csh_cb").click(function(e){var t=$(this).prop("checked"),a=$(this).attr("index");1==t?u.clm_show_csh(i,a):u.clm_hide_csh(i,a)}),o){0==(l=o[r]).show_flg&&this.clm_hide_csh(i,r)}$("#"+i+"_save_btn").click(function(e){var t,a,i;t=n,a=f(),i=JSON.stringify(a),localStorage.setItem(t+"_clmData",i),$("#csh_msg").show(),$("#csh_msg").fadeOut(3e3)}),$("#"+i+"_all_checked_btn").click(function(e){!function(e,t,a){var i=$("#"+u.props.chBoxsId);for(var n in a){var r=i.find("[index="+n+"]");if(r[0]){var l=r.prop("checked");0==l&&(r.prop("checked",!0),u.clm_show_csh(e,n))}}}(i,0,u.actClmData)}),$("#"+i+"_default_btn").click(function(e){c(i,t,n)})},this.getCshAry=function(){var e=$("#"+u.props.chBoxsId),t=[];for(var a in this.defClmData){var i=e.find("[index="+a+"]");if(i[0])1==i.prop("checked")?t.push(1):t.push(0)}return t},this.reset=function(){c(this.props.tblId,this.props.chBoxsId,this.props.unique)},this.refresh=function(){var e=this.props.tblId;for(var t in this.defClmData)this.clm_show_csh(e,t);var a=f();for(var t in a){var i=a[t].show_flg;1==i?this.clm_show_csh(e,t):0==i&&this.clm_hide_csh(e,t)}},this.clm_show_csh=function(e,t){$("#"+e+" thead tr th").eq(t).show(),$.each($("#"+e+" tbody tr"),function(){$(this).children().eq(t).show()})},this.clm_hide_csh=function(e,t){$("#"+e+" thead tr th").eq(t).hide(),$.each($("#"+e+" tbody tr"),function(){$(this).children().eq(t).hide()})}},CrudBase=function(){function n(e,t){_classCallCheck(this,n),this.param=this._setParamIfEmpty(e),this.formInfo=this._initFormInfo(this.param),this.fieldData=this._addMoreFieldData(this.param.tbl_slt,this.fieldData),this.fieldData=this._setFieldDataFromForm(this.fieldData,this.formInfo,"new_inp"),this.fieldData=this._setFieldDataFromForm(this.fieldData,this.formInfo,"edit"),this.fieldData=this._setFieldDataFromForm(this.fieldData,this.formInfo,"delete");var a=this.getForm("edit"),i=this.getForm("new_inp");this.fieldHashTable=this._createFieldHashTable(this.fieldData),this.defNiEnt=this._getEntByForm("new_inp"),this.tbl=jQuery("#"+this.param.tbl_slt),this.autoSave=this._factoryCrudBaseAutoSave(),this.rowExchange=this._factoryCrudBaseRowExchange(),this.csh=this._factoryClmShowHide(),this.cbFileUploadComp=this._factoryCbFileUploadComponent(),this.datepickerWrap=this._factoryDatepickerWrap(),this.cbBtnSizeChanger=this._factoryCbBtnSizeChanger(),this.calendarViewK=this._factoryCalendarViewK(),this.crudBaseReact=this._factoryCrudBaseReact(),this.crudBaseBulkAdd=new CrudBaseBulkAdd(this.fieldData),this.crudBasePasswordEdit=new CrudBasePasswordEdit(i,a),this.fueIdCash,"sp"==this.param.device_type&&this.tableTransform(1),this._formDragAndResizeSetting(),this._errByErrTypes(),this.actEditForm,this.activeTr,this.hiddensElm,this.formKjsElm,this._iniRtnSetUrl(),this._addEventForKjsEnter()}return _createClass(n,[{key:"_setParamIfEmpty",value:function(e){if(null==e&&(e={}),null==e.src_code)throw new Exception("'src_code' is empty!");if(null==e.src_code_c&&(e.src_code_c=this._snakeToCamel(e.src_code)),null==e.tbl_slt&&(e.tbl_slt=e.src_code+"_tbl"),null==e.edit_form_slt&&(e.edit_form_slt="ajax_crud_edit_form"),null==e.new_form_slt&&(e.new_form_slt="ajax_crud_new_inp_form"),null==e.delete_form_slt&&(e.delete_form_slt="ajax_crud_delete_form"),null==e.eliminate_form_slt&&(e.eliminate_form_slt="ajax_crud_eliminate_form"),null==e.contents_slt&&(e.contents_slt=null),null==e.edit_reg_url&&(e.edit_reg_url=e.src_code+"/ajax_reg"),null==e.new_reg_url&&(e.new_reg_url=e.src_code+"/ajax_reg"),null==e.delete_reg_url&&(e.delete_reg_url=e.src_code+"/ajax_delete"),null==e.auto_save_url&&(e.auto_save_url=e.src_code+"/auto_save"),null==e.file_uploads&&(e.file_uploads=null),null==e.form_width&&(e.form_width=null),null==e.form_height&&(e.form_height=null),null==e.form_position&&(e.form_position="auto"),null==e.form_z_index&&(e.form_z_index=9),null==e.valid_msg_slt&&(e.valid_msg_slt=".err"),null==e.auto_close_flg&&(e.auto_close_flg=0),null==e.ni_tr_place&&(e.ni_tr_place=0),null==e.disFilData&&(e.disFilData=null),null==e.kjs&&(e.kjs=null),null==e.device_type&&(e.device_type=this.judgDeviceType()),null==e.viaDpFnMap){var t=jQuery("#via_dp_fn_json").val();e.viaDpFnMap=jQuery.parseJSON(t)}if(null==e.errTypes){var a=jQuery("#err_types_json").val();e.errTypes=jQuery.parseJSON(a)}return null==e.drag_and_resize_flg&&(e.drag_and_resize_flg=1),null==e.form_mode&&(e.form_mode=1),e}},{key:"_factoryCrudBaseAutoSave",value:function(){var e=_typeof(CrudBaseAutoSave);return null==e||"undefined"==e?{saveRequest:function(){}}:new CrudBaseAutoSave(this)}},{key:"_factoryCrudBaseRowExchange",value:function(){var e,t=this,a=_typeof(CrudBaseRowExchange);if(null==a||"undefined"==a)return e={showForm:function(){}};e=new CrudBaseRowExchange(this,null,function(){t.rowExchangeAfter()});var i=jQuery("#row_exc_flg").val();return this.rowExcBtnShow(i),e}},{key:"_factoryClmShowHide",value:function(){var e,t=_typeof(ClmShowHide);if(null==t||"undefined"==t)return e={};e=new ClmShowHide;var a=jQuery("#csh_json").val(),i=JSON.parse(a),n="rkt_"+this.param.src_code+"_index";return e.init(this.param.tbl_slt,"clm_cbs",i,n),e}},{key:"_factoryCbFileUploadComponent",value:function(){var e=_typeof(CbFileUploadComponent);if(null==e||"undefined"==e)return{addEvent:function(){},getFileParams:function(){},uploadByAjax:function(){},getFileNames:function(){},setFilePaths:function(){}};var t=this._getFueIds("new_inp"),a=this._getFueIds("edit"),i=t.concat(a),n={pacb:this._fukPrevAfterCallback,pacb_param:{self:this}};return new CbFileUploadComponent(i,n)}},{key:"_factoryDatepickerWrap",value:function(){var e=_typeof(DatepickerWrap);return null==e||"undefined"==e?{tukishomatu:function(){}}:new DatepickerWrap(this)}},{key:"_factoryCbBtnSizeChanger",value:function(){var e=_typeof(CbBtnSizeChanger);return null==e||"undefined"==e?{dummy:function(){}}:new CbBtnSizeChanger}},{key:"_factoryCalendarViewK",value:function(){var e=_typeof(CalendarViewK);return null==e||"undefined"==e?{create:function(){}}:new CalendarViewK}},{key:"_factoryCrudBaseReact",value:function(){var e=_typeof(CrudBaseReact);return null==e||"undefined"==e?{init:function(){},reactivatingOfRow:function(){}}:new CrudBaseReact}},{key:"_getFueIds",value:function(e,t){if(null==t&&(t={}),null==t.cash_flg&&(t.cash_flg=1),1==t.cash_flg&&this.fueIdCash&&null!=this.fueIdCash[e])return this.fueIdCash[e];var a=[];for(var i in this.fieldData){var n=this.fieldData[i],r="inp_"+e;if(null!=n[r]){var l=n[r];if(null!=l.type_name&&"file"==l.type_name&&null!=l.elm){var s=l.elm.attr("id");a.push(s)}}}return null==this.fueIdCash&&(this.fueIdCash={}),this.fueIdCash[e]=a}},{key:"newInpShow",value:function(e,t,a){null==t&&(t={}),"add_to_top"==t.ni_tr_place?this.param.ni_tr_place=1:"add_to_bottom"==t.ni_tr_place&&(this.param.ni_tr_place=0),this.formInfo.new_inp.show_flg=1,this.setFieldsToForm("new_inp",this.defNiEnt);var i=this.getForm("new_inp");(this.setValueToFrom(i,"form_type","new_inp"),this._clearValidErr(i),a)&&a({form:i});if(1==this.param.form_mode){var n=(i=this._setColspanToForm(i)).find("td");if("sp"==this.param.device_type)n.attr("colspan",1),n.css("display","block"),i.css("display","block");else{var r=this._getClmCntByActive();n.attr("colspan",r),n.css("display","table-cell"),i.css("display","table-row")}if("add_to_top"==t.ni_tr_place){var l=this.tbl.find("tbody tr").eq(0);i.insertBefore(l)}else if("add_to_bottom"==t.ni_tr_place){var s=this.tbl.find("tbody tr").eq(-1);i.insertAfter(s)}else n.css("display","block"),i.css("display","block"),i.insertAfter("#new_inp_form_point")}else this._showForm(i,e,t);this.crudBasePasswordEdit.showForm("new_inp")}},{key:"editShow",value:function(e,t,a){null==t&&(t={});var i=jQuery(e).parents("tr");this.activeTr=i,this.formInfo.edit.show_flg=1;var n=this.getEntityByTr(i);this.setFieldsToForm("edit",n,t);var r=this.getForm("edit");r.show(),this._clearValidErr(r),a&&a(i,r,n),1==this.param.form_mode?(r=this._setColspanToForm(r)).insertAfter(i):this._showForm(r,e,t),this.crudBasePasswordEdit.showForm("edit")}},{key:"copyShow",value:function(e,t,a){var i=jQuery(e).parents("tr");this.activeTr=i,this.formInfo.new_inp.show_flg=1;var n=this.getEntityByTr(i),r=this.getForm("copy");this.setValueToFrom(r,"form_type","copy");var l=i.index();if(this.setValueToFrom(r,"row_index",l),this.setFieldsToForm("new_inp",n,t),this._clearValidErr(r),a&&a(i,r,n),1==this.param.form_mode){var s=(r=this._setColspanToForm(r)).find("td");if("sp"==this.param.device_type)s.attr("colspan",1),s.css("display","block"),r.css("display","block");else{var o=this._getClmCntByActive();s.attr("colspan",o),s.css("display","table-cell"),r.css("display","table-row")}r.insertAfter(i)}else this._showForm(r,e,t);this.crudBasePasswordEdit.showForm("copy")}},{key:"deleteAction",value:function(e,t){e instanceof jQuery||(e=jQuery(e)),null==t&&(t={}),null==t.form_show_flg&&(t.form_show_flg=0);var a=e.parents("tr");this.activeTr=a,1==t.form_show_flg?(t.tr=a,this.deleteShow(e,t)):(t.caller_type=1,this.deleteReg(t))}},{key:"enabledAction",value:function(e,t){e instanceof jQuery||(e=jQuery(e)),null==t&&(t={});var a=e.parents("tr");this.activeTr=a,this.enabledReg(t)}},{key:"eliminateShow",value:function(e,t,a){e instanceof jQuery||(e=jQuery(e));var i=e.parents("tr");this.activeTr=i;var n=this.formInfo.eliminate;n.show_flg=1;var r=this.getEntityByTr(i),l=jQuery(n.slt);this.setFieldsToForm("eliminate",r,t),a&&a(i,l,r),this._showForm(l,e,t)}},{key:"newInpReg",value:function(e,n,t){var r=this,a=this.getForm("new_inp");if(0!=this._validationCheckForm("new_inp")){this._empty(t)&&(t={}),this._toggleRegBtn("new_inp",0);var i=new FormData;i=this.cbFileUploadComp.setFilesToFd(i,"new_inp");var l=this._getEntByForm("new_inp"),s=!1;if(this._empty(l.id)||(s=!0),e){var o=e(l,i);if(o.err)return void this._errShow(o.err,"new_inp");o.ent?(l=o.ent,i=o.fd):l=o}var u=JSON.stringify(l);i.append("key1",u);var c={};t.wp_action&&(c.action=t.wp_action,t.wp_nonce&&(c.nonce=t.wp_nonce));var f=this.getValueFromForm(a,"form_type");c.form_type=f,c.ni_tr_place=this.param.ni_tr_place;var d=JSON.stringify(c);i.append("reg_param_json",d);var h=this._decAddRowIndex(a,f,t);jQuery.ajax({type:"post",url:this.param.new_reg_url,data:i,cache:!1,dataType:"text",processData:!1,contentType:!1}).done(function(t,e){var a;r._toggleRegBtn("new_inp",1);try{a=jQuery.parseJSON(t)}catch(e){return alert("エラー"),void jQuery("#err").html(t)}if(a.err)r._showErrToForm(a.err,"new_inp");else{1==s&&location.reload(!0),r.closeForm("new_inp");var i=r._addTr(a,h);r._switchBtnsDisplay(i,a),null!=n&&window.setTimeout(function(){n(a)},1)}}).fail(function(e,t,a){r._toggleRegBtn("new_inp",1),jQuery("#err").html(e.responseText),alert(t)})}}},{key:"editReg",value:function(e,n,t){var r=this;if(0!=this._validationCheckForm("edit")){this._empty(t)&&(t={}),this._toggleRegBtn("edit",0);var a=this._getEntByForm("edit"),i=new FormData;if(i=this.cbFileUploadComp.setFilesToFd(i,"edit"),e){var l=e(a,i);if(l.err)return void this._errShow(l.err,"edit");l.ent?(a=l.ent,i=l.fd):a=l}var s={},o=JSON.stringify(a);i.append("key1",o),t.wp_action&&(s.action=t.wp_action,t.wp_nonce&&(s.nonce=t.wp_nonce)),s.form_type="edit";var u=JSON.stringify(s);i.append("reg_param_json",u),jQuery.ajax({type:"post",url:this.param.edit_reg_url,data:i,cache:!1,dataType:"text",processData:!1,contentType:!1}).done(function(t,e){r._toggleRegBtn("edit",1);var a=null;try{a=jQuery.parseJSON(t)}catch(e){alert("エラー:"+t),console.log(t),jQuery("#err").html(t)}if(a){if(a.err)return void r._showErrToForm(a.err,"edit");var i=r._getTrInEditing();0==r.param.kj_delete_flg&&1==a.delete_flg&&i.hide(),a.id!=i.find(".id").text()&&location.reload(!0),r._setEntityToEditTr(a,i),null!=n&&window.setTimeout(function(){n(a)},1),i.css("background-color","#d7e6fd"),r.closeForm("edit")}}).fail(function(e,t,a){r._toggleRegBtn("edit",1),jQuery("#err").html(e.responseText),alert(t)})}}},{key:"deleteRegByRowIndex",value:function(e,t){var a=this.getEntity(e);this._deleteRegBase(a,1,t)}},{key:"eliminateReg",value:function(e){null==e&&(e={});var t=this._getEntByForm("eliminate");e.eliminate_flg=1;this._deleteRegBase(t,1,e)}},{key:"closeForm",value:function(e){var t=this.formInfo[e].form;jQuery("#crud_base_forms").append(t),t.hide()}},{key:"rowExchangeShowForm",value:function(e){this.rowExchange.showForm(e)}},{key:"rowExcBtnShow",value:function(e){1==e?jQuery(".row_exc_btn").show():jQuery(".row_exc_btn").hide()}},{key:"resetKjs",value:function(e){null==e&&(e=[]);var t=$("#def_kjs_json").val(),a=jQuery.parseJSON(t);for(var i in a)e.indexOf(i)<0&&$("#"+i).val(a[i]);this.cbGadgetKj.reset()}},{key:"getContainer",value:function(){return{param:this.param,fieldData:this.fieldData,fieldHashTable:this.fieldHashTable,formInfo:this.formInfo,defNiEnt:this.defNiEnt,formNewInp:this.formNewInp,formEdit:this.formEdit,formDelete:this.formDelete,showFormStrategy:this.showFormStrategy,react:this.react}}},{key:"getTblRowCount",value:function(){return jQuery("#"+this.param.tbl_slt).children("tbody").children("tr").length}},{key:"_decAddRowIndex",value:function(e,t,a){if(null!=a.add_row_index)return a.add_row_index;var i=-1;return 1==this.param.ni_tr_place&&(i=0),"copy"==t&&(i=this.getValueFromForm(e,"row_index"),i*=1,i++),i}},{key:"deleteShow",value:function(e,t){e instanceof jQuery||(e=jQuery(e));var a=t.tr;null==a&&(a=jQuery(e).parents("tr"));var i=this.formInfo.delete;i.show_flg=1;var n=this.getEntityByTr(a),r=jQuery(i.slt);this.setFieldsToForm("delete",n,t);var l=t.cbBeforeFormShow;l&&l(a,r,n),this._showForm(r,e,t)}},{key:"deleteReg",value:function(e){var t;null==e&&(e={}),null==e.caller_type&&(e.caller_type=0),t=0==e.caller_type?this._getEntByForm("delete"):this.getEntity();this._deleteRegBase(t,1,e)}},{key:"enabledReg",value:function(e){null==e&&(e={});var t=this.getEntity();this._deleteRegBase(t,0,e)}},{key:"_deleteRegBase",value:function(e,t,r){var l=this;if(!e.id)throw new Error("Not id");var s=0;r.eliminate_flg&&(s=r.eliminate_flg);var o="delete";s&&(o="eliminate"),e.delete_flg=t,null==r&&(r={});var a=new FormData,i={};i.form_type=o,r.wp_action&&(i.action=r.wp_action,r.wp_nonce&&(i.nonce=r.wp_nonce)),s&&(i.eliminate_flg=s);var n=JSON.stringify(i);a.append("reg_param_json",n);var u=r.cbBeforeReg;if(u){var c=u(e,a);if(c.err)return void this._errShow(c.err,o);c.ent?(e=c.ent,a=c.fd):e=c}var f=JSON.stringify(e);a.append("key1",f),jQuery.ajax({type:"post",url:this.param.delete_reg_url,data:a,cache:!1,dataType:"text",processData:!1,contentType:!1}).done(function(t,e){var a;try{a=jQuery.parseJSON(t)}catch(e){alert("エラー"),jQuery("#err").html(t)}if(a){if(0===l.param.kjs.kj_delete_flg||"0"===l.param.kjs.kj_delete_flg||1==s)l.activeTr.remove();else{var i=l._getTrInEditing();l._setEntityToEditTr(a,i)}var n=r.cbAfterReg;n&&window.setTimeout(function(){n(a)},1),l.closeForm(o)}}).fail(function(e,t,a){jQuery("#err").html(e.responseText),alert(t)})}},{key:"getTr",value:function(e){if(null==e)return this.activeTr;var t="#"+this.param.tbl_slt+" tbody tr";return jQuery(t).eq(e)}},{key:"getLastTr",value:function(){var e="#"+this.param.tbl_slt+" tbody tr";return jQuery(e).eq(-1)}},{key:"_getTrInEditing",value:function(){return this.activeTr}},{key:"getTd",value:function(e,t){var a=this.getTr(e).find("."+t);return a[0]?a.parents("td"):null}},{key:"getTdInEditing",value:function(e){var t=this._getTrInEditing().find("."+e);return t[0]?t.parents("td"):null}},{key:"getEntity",value:function(e){var t=this.getTr(e);return this.getEntityByTr(t)}},{key:"getEntityByTr",value:function(e){var t={};for(var a in this.fieldData){var i=this.fieldData[a].field,n=e.find("[name='"+i+"']");t[i]=n.val()}return t}},{key:"getEntityByInnerElm",value:function(e){var t=jQuery(e).parents("tr").index();return this.getEntity(t)}},{key:"getDataFromTbl",value:function(e){var n=this;null==e&&(e=this.tbl),e instanceof jQuery||(e=jQuery(e));var t=e.find("tbody tr"),r=[];return t.each(function(e,t){var a=jQuery(t),i=n.getEntityByTr(a);r.push(i)}),r}},{key:"getDataFromTblByFields",value:function(r){var l=this,e="#"+this.param.tbl_slt+" tbody tr",s=[];return jQuery(e).each(function(e,t){var a=jQuery(t),i={};for(var e in r){var n=r[e];t=a.find("."+n);i[n]=l._getValueEx(t)}s.push(i)}),s}},{key:"_getValueEx",value:function(e){var t=e.prop("tagName");return"INPUT"==t||"SELECT"==t||"TEXTAREA"==t?e.val():e.html()}},{key:"getValueFromForm",value:function(e,t){var a=this._formFind(e,t),i=null;return a[0]&&(i=this._getValueEx(a)),i}},{key:"setValueToFrom",value:function(e,t,a){var i=this._formFind(e,t);i[0]&&this._setValueEx(i,a)}},{key:"_showErrToForm",value:function(e,t){var a=e;Array.isArray(a)&&(a=a.join("<br>"));var i=this.formInfo[t];jQuery(i.slt).find(".err").html(a)}},{key:"_clearValidErr",value:function(e){var t=e.find(this.param.valid_msg_slt);for(var a in t.html(""),this.fieldData){var i=this.fieldData[a].field,n=e.find("[for='"+i+"']");n[0]&&(n.html(""),n.hide())}}},{key:"_validationCheckForm",value:function(e){var i=this,n=!0,t=this.formInfo[e];return jQuery(t.slt).find(".valid").each(function(e,t){t=jQuery(t);var a=i._getFieldByNameOrClass(t);0==i._validationCheck(t,a)&&(n=!1)}),n}},{key:"_validationCheck",value:function(e,t){var a=!0,i=jQuery("[for='"+t+"']"),n=e.attr("title");try{1==(a=e[0].checkValidity())?(i.attr("class","text-success"),i.html("")):(i.attr("class","text-danger"),i.html(n),i.show())}catch(e){throw e}return a}},{key:"_resetFileUpload",value:function(e){e.evt=null;var t=e.elm;try{t.val("")}catch(e){console.log("It can not be reset in IE ")}var a=jQuery("#"+e.preview_slt);return a.attr("src",""),a.hide(),e}},{key:"addTr",value:function(e,t,a){this._addTr(e,t,a)}},{key:"_addTr",value:function(e,t,a){null==t&&(t=-1),t*=1,a||(a={});var i="#"+this.param.tbl_slt,n=jQuery(i+" tbody tr");0==n.length&&location.reload(!0);var r="<tr style='background-color:#fdeaea'>"+n.eq(0).html()+"</tr>",l=this._insertTr(i,t,r);return a.form_type="new_inp",this.setEntityToTr(l,e,a),l}},{key:"_insertTr",value:function(e,t,a){var i=jQuery(e+" tbody"),n=i.find("tr"),r=n.length,l=null;if(0<r)if(t<r&&-1<t){var s=n[t];jQuery(s).before(a),l=t}else{s=n[r-1];jQuery(s).after(a),l=r}else i.append(a),l=0;var o=(n=i.find("tr"))[l];return jQuery(o)}},{key:"_setEntityToEditTr",value:function(e,t,a){if(null!=e){if(a||(a={}),null==t)t=this._getTrInEditing();a.form_type="edit",this.setEntityToTr(t,e,a),this._switchBtnsDisplay(t,e)}}},{key:"_switchBtnsDisplay",value:function(e,t){1==t.delete_flg?(this._switchBtnDisp(e,".row_delete_btn",0),this._switchBtnDisp(e,".row_enabled_btn",1),this._switchBtnDisp(e,".row_eliminate_btn",1)):(this._switchBtnDisp(e,".row_delete_btn",1),this._switchBtnDisp(e,".row_enabled_btn",0),this._switchBtnDisp(e,".row_eliminate_btn",0))}},{key:"_switchBtnDisp",value:function(e,t,a){var i=e.find(t);i[0]&&(a?i.show():i.hide())}},{key:"setDataToTbl",value:function(e,i,n){var r=this;null==e&&(e=this.tbl),e.find("tbody tr").each(function(e,t){if(null!=i[e]){t=jQuery(t);var a=i[e];r.setEntityToTr(t,a,n)}})}},{key:"setEntityToTr",value:function(e,t,a){if(null!=t){null==a&&(a={});var i=1;null!=a.xss_flg&&(i=a.xss_flg),1==i&&(t=this._xssSanitaizeEncode(t)),this.entToBinds(e,t,"class",a),this.entToBinds(e,t,"name",a),this.cbFileUploadComp.setImageToTr(e,t,this.param.viaDpFnMap)}}},{key:"_nl2brEx",value:function(e){return null==e||""==e||"0"==e?e:"string"!=typeof e?e:e=e.replace(/\r\n|\n\r|\r|\n/g,"<br>")}},{key:"_getEntByForm",value:function(e){var i=this,t=this._getTrInEditing(),a={},n=this.getForm(e);"edit"!=e&&"delete"!=e||(a=this.getEntityByTr(t));var r={};for(var l in this.fieldData){var s=this.fieldData[l].field,o=this._formFind(n,s),u=o.length,c=null;0!=u&&(1==u?c=this._getEntByForm2(o,n,s):o.each(function(e,t){var a=jQuery(t);c=i._getEntByForm2(a,n,s)}),r[s]=c)}return jQuery.extend(a,r),a}},{key:"getForm",value:function(e,t){var a;if(null==t&&(t=1),"new_inp"==e||"copy"==e)a=1==t&&null!=this.formNewInp?this.formNewInp:jQuery("#"+this.param.new_form_slt),this.formNewInp=a;else if("edit"==e)a=1==t&&null!=this.formEdit?this.formEdit:jQuery("#"+this.param.edit_form_slt),this.formEdit=a;else if("delete"==e)a=1==t&&null!=this.formDelete?this.formDelete:jQuery("#"+this.param.delete_form_slt),this.formDelete=a;else{if("eliminate"!=e)throw new Error("Uknown form_type!");a=1==t&&null!=this.formEliminate?this.formEliminate:jQuery("#"+this.param.eliminate_form_slt),this.formEliminate=a}return a}},{key:"_getEntByForm2",value:function(e,t,a){var i=e.get(0).tagName,n=null;if("INPUT"==i||"SELECT"==i||"TEXTAREA"==i){var r=e.attr("type");if("file"==r){var l=e.attr("id");if(this.cbFileUploadComp){var s=this.cbFileUploadComp.getFileNames(l);null!=s[0]&&(n=s[0])}}else if("checkbox"==r)n=0,e.prop("checked")&&(n=1);else if("radio"==r){var o=t.find("[name='"+a+"']:checked");o[n=0]&&(n=o.val())}else n=e.val()}else n="IMG"==i?this._getValFromLabel(t,a):e.html();return n}},{key:"_getValFromLabel",value:function(e,t){var a=null,i=e.find("[for='"+t+"']");return i[0]&&(a=i.html()),a}},{key:"_formFind",value:function(e,t){var a=e.find("[name='"+t+"']");return null==a[0]&&(a=e.find("."+t)),a}},{key:"_convertFormToDlg",value:function(e,t){var a=this.param;null==t&&(t=a.form_z_index);var i=e.form,n={"z-index":t,position:"absolute"};i.css(n),1==this.param.auto_close_flg&&(jQuery(document).click(function(){1==e.show_flg?e.show_flg=0:jQuery(e.slt).hide()}),i.click(function(e){e.stopPropagation()})),i.hide()}},{key:"judgDeviceType",value:function(){var e="pc";return screen.width<=480&&(e="sp"),e}},{key:"_setFieldDataFromForm",value:function(e,t,a){var i=t[a].form;for(var n in e){var r=e[n],l=r.field,s={elm:null,tag_name:null,type_name:null,accept:""},o=this._formFind(i,l);if(null!=(s.elm=o)[0]){var u=o.get(0).tagName;if("INPUT"==(s.tag_name=u)||"SELECT"==u||"TEXTAREA"==u){var c=o.attr("type");if("file"==(s.type_name=c)){var f=o.attr("accept");s.accept=f}}r["inp_"+a]=s}}return e}},{key:"trToDiv",value:function(e,t,a){var i=this.getEntity(t);this.entToBinds(e,i,"class",a),this.entToBinds(e,i,"name",a)}},{key:"entToBinds",value:function(e,t,a,i){var n=this.getBindElms(e,a,i);for(var r in i||(i={}),"class"==a?i.dis_fil_flg=1:"name"==a&&(i.dis_fil_flg=0),this.fieldData){var l=this.fieldData[r].field;if(void 0!==t[l]){var s=n[l];for(var o in s){var u=s[o];this.setValueToElement(u,l,t[l],t,i)}}}}},{key:"getBindElms",value:function(e,t){var a={};for(var i in e instanceof jQuery||(e=jQuery(e)),this.fieldData){var n,r=this.fieldData[i];if("class"==t)n=e.find("."+r.field);else{if("name"!=t)continue;n=e.find("[name='".concat(r.field,"']"))}if(n[0]){for(var l=[],s=0;s<n.length;s++)l.push(n.eq(s));a[r.field]=l}}return a}},{key:"setFieldsToForm",value:function(e,t,a){var i=this.getForm(e);null==a&&(a={}),a.par=i,a.form_type=e,this.entToBinds(i,t,"class",a),this.entToBinds(i,t,"name",a)}},{key:"setValueToElement",value:function(e,t,a,i,n){e instanceof jQuery||(e=jQuery(e)),null==n&&(n={});var r=0;r=null==n.xss?1:n.xss;var l=e.get(0).tagName;if(n.dis_fil_flg){var s=this.displayFilter(a,t,n.disFilData,r);a=s.val1,r=s.xss}if("INPUT"==l||"SELECT"==l){var o=e.attr("type");if("file"==o)this._setToFormForFile(n.form_type,n.par,t,a,i,n);else if("checkbox"==o)0==a||null==a||""==a?e.prop("checked",!1):e.prop("checked",!0);else if("radio"==o){var u=n.par.find("[name='"+t+"'][value='"+a+"']");if(u[0])u.prop("checked",!0);else if(this._empty(a))n.par.find("[name='"+t+"']").prop("checked",!1)}else a=this._xssSanitaizeDecode(a),e.val(a)}else"TEXTAREA"==l?(""!=a&&null!=a&&(a=a.replace(/<br>/g,"\r"),a=this._xssSanitaizeDecode(a)),e.val(a)):("string"==typeof a&&(a=a.replace(/<br>/g,"\r"),1==n.xss&&(a=this._xssSanitaizeEncode(a)),a=this._nl2brEx(a)),e.html(a))}},{key:"displayFilter",value:function(e,t,a,i){var n={val1:e,xss:i};if(a||(a=this.param.disFilData),!a)return n;if(!a[t])return n;var r=a[t];i=0;switch(r.fil_type){case"select":n.val1=this.disFilSelect(e,t,r.option);break;case"delete_flg":n.val1=this.disFilDeleteFlg(e,t,r.option),n.xss=0;break;case"flg":n.val1=this.disFilFlg(e,t,r.option),n.xss=0;break;case"money":n.val1=this.disFilMoney(e,t,r.option),n.xss=0}return n}},{key:"setDisplayFilterData",value:function(e){this.param.disFilData=e}},{key:"disFilSelect",value:function(e,t,a){if(null==e)return e;var i={};a&&a.list&&(i=a.list);var n="";return null!=i[e]&&(n=i[e]),n}},{key:"disFilDeleteFlg",value:function(e,t,a){return null==e?e:1==e?'<span style="color:#b4b4b4;">削除</span>':'<span style="color:#23d6e4;">有効</span>'}},{key:"disFilFlg",value:function(e,t,a){null!=e&&""!=e&&0!=e||(e=0),0<e&&(e=1);var i=a.list[e];return 1==e?'<span style="color:#23d6e4;">'+i+"</span>":'<span style="color:#b4b4b4;">'+i+"</span>"}},{key:"disFilMoney",value:function(e,t,a){if(null==e)return e;var i="&yen;";return a&&a.currency&&(i=a.currency),i+String(e).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}},{key:"_setToFormForFile",value:function(e,t,a,i,n,r){var l=null;for(var s in this.fieldData){var o=this.fieldData[s];if(o.field==a){var u=o["inp_"+e];if(null==u)break;if(null==u.elm)break;l=u.elm.attr("id");break}}var c="";null!=this.param.viaDpFnMap[a]&&(c=n[this.param.viaDpFnMap[a]]);this.cbFileUploadComp.setFilePaths(l,i,c).dpData}},{key:"_getFieldEntByField",value:function(e){var t=this.fieldHashTable[e];return this.fieldData[t]}},{key:"_showForm",value:function(e,t,a){if(null==a&&(a={}),null==a.form_position&&(a.form_position=this.param.form_position,"sp"==this.param.device_type&&(a.form_position="max")),"sp"==this.param.device_type){var i=e.find("table");i.addClass("tbl_sp"),i.find("label.text-danger").hide()}if((null==a.use_show_form_strategy&&(a.use_show_form_strategy=1),0==this.param.auto_close_flg&&(this.param.form_z_index++,e.css("z-index",this.param.form_z_index)),e.show(),1==a.use_show_form_strategy&&null!=this.showFormStrategy)&&1==this.showFormStrategy.showForm(e,t))return;t instanceof jQuery||(t=jQuery(t));var n=t.offset(),r=n.left,l=n.top,s=jQuery(window).width(),o=this.param.form_width,u=this.param.form_height;this._empty(o)&&(o=e.outerWidth()),this._empty(u)&&(u=e.outerHeight());var c=l+t.outerHeight(),f=0,d=s;if(!this._empty(this.param.contents_slt)){var h=jQuery(this.param.contents_slt);h[0]&&(f=h.offset.left,d=h.width())}switch(a.form_position){case"left":f=r-o;break;case"center":f=d/2-o/2;break;case"right":f=r;break;case"max":o=d-2;break;default:d<(f=r)+o&&(f=d-o)}f<0&&(f=0),e.offset({top:c,left:f}),this._empty(o)||e.width(o),this._empty(u)||e.height(u),this._fitForm(e)}},{key:"_addMoreFieldData",value:function(e,r){if(!r&&!(r=this._getFieldDataFromTh()))throw new Error("fieldDataを取得できません。th要素のclass属性にフィールド名を指定してください。");var l=[];return jQuery("#"+e+" th").each(function(e,t){var a=jQuery(t).text(),i=null;if(r[e]&&(i=r[e]),null!=i){var n={index:e,field:i,wamei:a};l.push(n),e++}}),l}},{key:"_getFieldDataFromTh",value:function(){var n=this,r=[],e="#"+this.param.tbl_slt+" th";return jQuery(e).each(function(e,t){var a=jQuery(t),i=n._getFieldByClassOrName(a);i&&r.push(i)}),r}},{key:"_createFieldHashTable",value:function(e){var t={};for(var a in e){t[e[a].field]=a}return t}},{key:"_initFormInfo",value:function(e){var t={},a=this._classifySlt(e.new_form_slt),i=jQuery(a.slt);t.new_inp={xid:a.xid,slt:a.slt,show_flg:0,form:i},0==this.param.form_mode&&this._convertFormToDlg(t.new_inp),a=this._classifySlt(e.edit_form_slt);var n=jQuery(a.slt);t.edit={xid:a.xid,slt:a.slt,show_flg:0,form:n},0==this.param.form_mode&&this._convertFormToDlg(t.edit);a=this._classifySlt(e.delete_form_slt);var r=jQuery(a.slt);t.delete={xid:a.xid,slt:a.slt,show_flg:0,form:r},this._convertFormToDlg(t.delete);a=this._classifySlt(e.eliminate_form_slt);var l=jQuery(a.slt);return t.eliminate={xid:a.xid,slt:a.slt,show_flg:0,form:l},this._convertFormToDlg(t.eliminate),t}},{key:"_errShow",value:function(e,t){var a=this.getForm(t);if(this._clearValidErr(a),"string"==typeof e)(n=a.find(this.param.valid_msg_slt))[0]&&(1<n.length&&(n=n.eq(0)),n.html(e.err_msg)),n.html(e);else if(e[0])for(var i in e){var n,r=e[i];(n=a.find(r.err_slt)).html(r.err_msg)}else(n=a.find(e.err_slt)).html(e.err_msg)}},{key:"searchKjs",value:function(){var r=this,e=this._getUrlQuery(),t=this._getFormKjsElm(),l={},s=[];for(var a in t.find(".kjs_inp").each(function(e,t){var a=jQuery(t),i=a.val(),n=a.attr("id");r._emptyNotZero(i)?s.push(n):(i=encodeURIComponent(i),l[n]=i)}),jQuery.extend(e,l),s){delete e[s[a]]}e.page_no=0;var i,n="";for(var o in e){n+=o+"="+e[o]+"&"}""!=n&&(i="?"+(n=n.substr(0,n.length-1))),window.location.href=i}},{key:"isDefaultKjs",value:function(e,t,a){if(null==t){var i=$("#kjs_json").html();t=JSON.parse(i)}if(null==a){var n=$("#def_kjs_json").val();a=JSON.parse(n)}var r={};for(var l in e){r[o=e[l]]=1}var s=1;for(var o in a)if(!r[o]&&null!==t[o]){var u=t[o];this._emptyNotZero(u)&&(u=null);var c=a[o];if(this._emptyNotZero(c)&&(c=null),u!=c){s=0;break}}return s}},{key:"_getFieldByNameOrClass",value:function(e){var t=e.attr("name");if(t||(t=e.attr("class")),!t)return t;var a=(t=t.trim()).indexOf(" ");return-1!=a&&(t=t.substr(0,t.length-a)),t}},{key:"_getFieldByClassOrName",value:function(e){var t=e.attr("class");if(t||(t=e.attr("name")),!t)return t;var a=(t=t.trim()).indexOf(" ");return-1!=a&&(t=t.substr(0,t.length-a)),t}},{key:"_classifySlt",value:function(e){var t="",a="";if(!e)return{xid:t,slt:a};a="#"==e.charAt(0)?(t=e.replace("#",""),e):"#"+(t=e);var i={xid:t,slt:a};return i}},{key:"_xssSanitaizeEncode",value:function(e){if("object"!=_typeof(e))return"string"==typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;"):e;for(var t in e)e[t]=this._xssSanitaizeEncode(e[t]);return e}},{key:"_xssSanitaizeDecode",value:function(e){if("object"!=_typeof(e))return"string"==typeof e?e.replace(/&lt;/g,"<").replace(/&gt;/g,">"):e;for(var t in e)e[t]=this._xssSanitaizeDecode(e[t]);return e}},{key:"_nl2br",value:function(e){return"string"==typeof e?e.replace(/[\n\r]/g,"<br>"):e}},{key:"_empty",value:function(e){return null==e||""==e||"0"==e||"object"==_typeof(e)&&0==Object.keys(e).length}},{key:"_emptyNotZero",value:function(e){var t=this._empty(e);return t&&(0!==e&&"0"!==e||(t=!1)),t}},{key:"_getUrlQuery",value:function(){if(""==(e=window.location.search)||null==e)return{};for(var e=e.substring(1,e.length),t=e.split("&"),a={},i=0;i<t.length;i++){var n=t[i].split("=");a[n[0]]=n[1]}return a}},{key:"setShowFormStrategy",value:function(e){this.showFormStrategy=e}},{key:"_setValueEx",value:function(e,t){if(e[0]){var a=e.get(0).tagName;if("INPUT"==a||"SELECT"==a){var i=e.attr("type");if("checkbox"==i)0==t||null==t||""==t?e.prop("checked",!1):e.prop("checked",!0);else if("radio"==i){var n=e.attr("name"),r=e.parent().find("[name='"+n+"'][value='"+t+"']");r[0]&&r.prop("checked",!0)}else"string"==typeof t&&(t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">")),e.val(t)}else"TEXTAREA"==a?(""!=t&&null!=t&&"string"==typeof(t=t.replace(/<br>/g,"\r"))&&(t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">")),e.val(t)):"IMG"==a?e.attr("src",t):"AUDIO"==a?e.attr("src",t):(""!=t&&null!=t&&("string"==typeof(t=t.replace(/<br>/g,"\r"))&&(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;")),t=t.replace(/\r\n|\n\r|\r|\n/g,"<br>")),e.html(t))}}},{key:"saveRequest",value:function(e,t){this.autoSave.saveRequest(e,t)}},{key:"escapeForAjax",value:function(e){if("string"==typeof e)return-1!=e.indexOf("&")?(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),encodeURIComponent(e)):e;if("object"!=_typeof(e))return e;for(var t in e)e[t]=this.escapeForAjax(e[t]);return e}},{key:"rowExchangeAfter",value:function(){var e=this.getDataFromTbl(),t=1*jQuery("#page_no").val()*(1*jQuery("#row_limit").val())+1;for(var a in e){e[a].sort_no=t,t++}this.saveRequest(e,{reflect_on_tbl:1})}},{key:"_toggleRegBtn",value:function(e,t){var a=this.getForm(e),i=a.find(".reg_btn"),n=a.find(".reg_btn_msg");0==t?(i.prop("disabled",!0),n.html("　登録中・・・")):(i.prop("disabled",!1),n.html(""))}},{key:"_snakeToCamel",value:function(e){return e=(e=e.replace(/_./g,function(e){return e.charAt(1).toUpperCase()})).charAt(0).toUpperCase()+e.slice(1)}},{key:"getKjElms",value:function(){var i={};return jQuery(".kj_wrap").each(function(e,t){var a=(t=jQuery(t)).attr("data-field");i[a]=t}),i}},{key:"tableTransform",value:function(e){1==e?(this.tbl.addClass("table_transform"),jQuery("#table_transform_tbl_mode").show(),jQuery("#table_transform_div_mode").hide()):(this.tbl.removeClass("table_transform"),jQuery("#table_transform_tbl_mode").hide(),jQuery("#table_transform_div_mode").show())}},{key:"_fukPrevAfterCallback",value:function(e,t,a){if(null!=e){var i=e.slice(-2),n=null;if("_n"==i)n="new_inp";else{if("_e"!=i)return;n="edit"}a.self._fitFormByFormType(n)}}},{key:"_fitFormByFormType",value:function(e){var t=this.getForm(e);this._fitForm(t)}},{key:"_fitForm",value:function(e){1==this.param.form_mode?e.css({width:"auto",height:"auto"}):e.css({width:"auto",height:"auto",display:"inline-block"})}},{key:"_formDragAndResizeSetting",value:function(){0==this.param.form_mode&&(this._formDragAndResizeSetting2("new_inp"),this._formDragAndResizeSetting2("edit")),this._formDragAndResizeSetting2("delete"),this._formDragAndResizeSetting2("eliminate")}},{key:"_formDragAndResizeSetting2",value:function(e){if(1==this.param.drag_and_resize_flg){var t=this.getForm(e),a=t.draggable();$(".panel-body",a).mousedown(function(e){a.draggable("disable")}).mouseup(function(e){a.draggable("enable")}),t.resizable()}}},{key:"_errByErrTypes",value:function(){0<=this.param.errTypes.indexOf("kjs_err")&&jQuery(".cb_kj_detail").show()}},{key:"openNoteDetail",value:function(e,t){null==t&&(t="note");var a=e.parents("td"),i=(a.find("[name='"+t+"']"),a.find("."+t)),n=1,r=a.find(".note_detail");if(!r[0]){n=0;a.append("<div class='note_detail'></div>"),r=a.find(".note_detail")}if("none"==i.css("display"))return i.show(),r.hide(),void e.val("...");if(n)return i.hide(),r.show(),void e.val("閉じる");var l=a.find("[name='"+t+"']").val();null!=l&&""!=l&&(l=(l=this._xssSanitaizeEncode(l)).replace(/\r\n|\n\r|\r|\n/g,"<br>"),r.html(l),i.hide(),e.val("閉じる"))}},{key:"_setColspanToForm",value:function(e){var t=this._getClmCntByActive();return e.find("td").attr("colspan",t),e}},{key:"_getClmCntByActive",value:function(){var e=this.csh.getCshAry(),t=1;for(var a in e)e[a]&&t++;return t}},{key:"_setColspanToTd",value:function(e){var t=this.csh.getCshAry(),a=1;for(var i in t)t[i]&&a++;return form.find("td").attr("colspan",a),form}},{key:"_iniRtnSetUrl",value:function(){var e=this._getHiddensElm(),t=e.find("#referer_url").val(),a=e.find("#now_url").val(),i="";this._stringLeft(t,"?",1)==this._stringLeft(a,"?",1)?null==(i=localStorage.getItem("crud_base_ini_rtn_url"))&&(i=a):(i=a,localStorage.setItem("crud_base_ini_rtn_url",i)),jQuery(".ini_rtn").attr("href",i)}},{key:"_getHiddensElm",value:function(){return null==this.hiddensElm&&(this.hiddensElm=jQuery("#hiddens_data")),this.hiddensElm}},{key:"_stringLeft",value:function(e,t,a){if(null==e||""==e)return e;var i=e.indexOf(t);return-1==i&&1==a?e:e.substring(0,i)}},{key:"_addEventForKjsEnter",value:function(){var t=this;this._getFormKjsElm().find("input").keypress(function(e){13==e.which&&t.searchKjs()})}},{key:"_getFormKjsElm",value:function(){return null==this.formKjsElm&&(this.formKjsElm=jQuery(".form_kjs")),this.formKjsElm}},{key:"calendarViewCreate",value:function(e){var t=this.getDataFromTbl();this.calendarViewK.create(t,e)}},{key:"reactInit",value:function(e){var t=new Date,a=t.getTime(),i=this._getFields();this.crudBaseReact.init(i,e);new Date;var n=t.getTime()-a;console.log("タイム："+n)}},{key:"reactivatingOfRow",value:function(){this.crudBaseReact.reactivatingOfRow()}},{key:"_getFields",value:function(){if(null!=this.fields)return this.fields;var e=[];for(var t in this.fieldData){var a=this.fieldData[t];e.push(a.field)}return this.fields=e,this.fields}}]),n}(),CrudBaseAutoSave=function(){function t(e){_classCallCheck(this,t),this.crudBase=e,this.fieldData=e.fieldData,this.tbl=e.tbl,this.msgElm=jQuery("#crud_base_auto_save_msg"),this.data,this.set_timeout_hdl}return _createClass(t,[{key:"saveRequest",value:function(e,t){var a=this;this.data=e,null==t&&(t={}),null==t.reflect_on_tbl&&(t.reflect_on_tbl=0),null==t.interval&&(t.interval=3e3),null!=this.set_timeout_hdl&&clearTimeout(this.set_timeout_hdl),this.set_timeout_hdl=setTimeout(function(){a._autoSave(a.data),1==t.reflect_on_tbl&&a.crudBase.setDataToTbl(null,e)},t.interval)}},{key:"_autoSave",value:function(e){var i=this;if(this.msgElm.html("保存中..."),console.log("自動保存"),null==e)e=this.crudBase.getDataHTbl();e=this.crudBase.escapeForAjax(e);var t=JSON.stringify(e),a=this.crudBase.param.auto_save_url;jQuery.ajax({type:"POST",url:a,data:"key1="+t,cache:!1,dataType:"text"}).done(function(t,e){try{jQuery.parseJSON(t),i.msgElm.html("")}catch(e){return i.msgElm.html("自動保存のエラー1"),void jQuery("#err").html(t)}}).fail(function(e,t,a){i.msgElm.html("自動保存のエラー2"),jQuery("#err").html(e.responseText)})}}]),t}(),CrudBaseBulkAdd=function(){function t(e){_classCallCheck(this,t),this.fieldData=e}return _createClass(t,[{key:"init",value:function(e,t){for(var a in e){var i=e[a];i.wamei=this._getWameiFromFieldData(i.field)}this.inpFields=e,this.param=this._initParam(t)}},{key:"_getWameiFromFieldData",value:function(e){var t=e;for(var a in this.fieldData){var i=this.fieldData[a];if(e==i.field){t=i.wamei;break}}return t}},{key:"_initParam",value:function(e){if(null==e&&(e={}),null==e.ajax_url)throw new Error("Not empty ajax_url in param!");return null==e.ta_placeholder&&(e.ta_placeholder="Excelからコピーした行列を貼り付けてください。\n(例)\nネコ名A\t100\nネコ名B\t101\n"),null==e.ta_height&&(e.ta_height="20rem"),null==e.test_mode&&(e.test_mode=0),e}},{key:"showForm",value:function(){var t=this;if(this.form)return this.form.show(),this.form.find("#cbba_inps_div").show(),void this.form.find("#cbba_preview_div").hide();var e=this.param,a=this._makeSameApplysHtml(),i="";this.param.test_mode&&(i=this._getTestText());var n='\n\t\t\t<div id="cbba_div" >\n\t\t\t\t<div id="cbba_head" >\n\t\t\t\t\t<h4>一括追加</h4>\n\t\t\t\t\t<div id="cbba_close_btn_w" style="">\n\t\t\t\t\t\t<input id="cbba_close_btn" type=\'button\' value="閉じる" class="btn btn-primary btn-xs" onclick="" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div style="clear:both"></div>\n\t\t\t\t\n\t\t\t\t<div id="cbba_inps_div">\n\t\t\t\t\t<textarea id="cbba_ta" placeholder="'.concat(e.ta_placeholder,"\" style='height:").concat(e.ta_height,"'>").concat(i,'</textarea>\n\t\t\t\t\t<div id="cbba_same_applys_w">').concat(a,'</div>\n\t\t\t\t\t<div id="cbba_preview_btn_w">\n\t\t\t\t\t\t<input id="cbba_preview_btn" type="button" value="プレビュー" class="btn btn-success" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div id="cbba_preview_div" style="display:none">\n\t\t\t\t\t<div id="cbba_preview_div2">\n\t\t\t\t\t</div>\n\t\t\t\t\t<input id="cbba_reg_btn" type="button" value="一括追加" class="btn btn-danger" />\n\t\t\t\t\t<input id="cbba_rtn_btn" type="button" value="戻る" class="btn btn-primary" />\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div id="cbba_err" class="text-danger"></div>\n\t\t\t</div>\n\t\t'),r=jQuery("#crud_base_bulk_add");r.html(n),r.find("#cbba_close_btn").click(function(e){t.form.hide()}),r.find("#cbba_reg_btn").click(function(e){t._bulkAdd()}),r.find("#cbba_rtn_btn").click(function(e){t._returnToInput()}),r.find("#cbba_preview_btn").click(function(e){t._preview()}),this.form=r,this.form.show()}},{key:"_returnToInput",value:function(){this.form.find("#cbba_preview_div").hide(),this.form.find("#cbba_inps_div").show()}},{key:"_getTestText",value:function(){return"ロイヤルアナロスタン\t101\nロード・ゴート\t102\nツィッツァ\t103\nイッパイアッテナ\t104\n<input />\t105\nおキャット様.'\"\t106"}},{key:"_makeSameApplysHtml",value:function(){var e="",t=this.inpFields;for(var a in t){var i=t[a];switch(i.inp_type){case"text":e+=this._makeSameApplyTypeText(i);break;case"date":e+=this._makeSameApplyTypeDate(i);break;case"select":e+=this._makeSameApplyTypeSelect(i);break;case"sort_no":e+=this._makeSameApplyTypeSortNo(i)}}return e}},{key:"_makeSameApplyTypeText",value:function(e){var t="";return null!=e.def&&(t=e.def),'\n\t\t\t<div class="same_apply_w">\n\t\t\t\t<label>'.concat(e.wamei,'</label>\n\t\t\t\t<input type="text" class="same_apply ').concat(e.field,'" value="').concat(t,'" />\n\t\t\t</div>\n\t\t')}},{key:"_makeSameApplyTypeDate",value:function(e){var t="";return null!=e.def&&(t=e.def,t=this._convDateTo_yyyymmdd(t)),'\n\t\t\t<div class="same_apply_w">\n\t\t\t\t<label>'.concat(e.wamei,'</label>\n\t\t\t\t<input type="date" class="same_apply ').concat(e.field,'" value="').concat(t,'" />\n\t\t\t</div>\n\t\t')}},{key:"_makeSameApplyTypeSelect",value:function(e){var t=null;null!=e.def&&(t=e.def);var a="";for(var i in e.list){var n=e.list[i],r="";t==i&&(r="selected"),a+="<option value='".concat(i,"' ").concat(r,">").concat(n,"</option>")}return'\n\t\t\t<div class="same_apply_w">\n\t\t\t\t<label>'.concat(e.wamei,'</label>\n\t\t\t\t<select class="same_apply ').concat(e.field,'">').concat(a,"</select>\n\t\t\t</div>\n\t\t")}},{key:"_makeSameApplyTypeSortNo",value:function(e){var t="",a="";return 1==e.def?a="checked":t="checked",'\n\t\t\t<div class="same_apply_w">\n\t\t\t\t<label>追加場所</label>\n\t\t\t\t<label class=\'cbba_sort_no_label\'>\n\t\t\t\t\t<input type="radio" name="cbba_sort_no" value="0" '.concat(t,'>\n\t\t\t\t\t先頭に追加\n\t\t\t\t</label>\n\t\t\t\t<label class=\'cbba_sort_no_label\'>\n\t\t\t\t\t<input type="radio" name="cbba_sort_no" value="1" ').concat(a,">\n\t\t\t\t\t末尾に追加\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t")}},{key:"_convDateTo_yyyymmdd",value:function(e){if("string"==typeof e&&"Invalid Date"==(e=new Date(e)))return null;var t=e.getFullYear(),a=e.getMonth()+1;a=("0"+a).slice(-2);var i=e.getDate();return t+"-"+a+"-"+(i=("0"+i).slice(-2))}},{key:"_preview",value:function(){var e=[];if(e=this._getDataFromTextArea(e),this._err(""),0!=e.length){e=this._getDataFromSameApplys(e);var t=jQuery.extend(!0,{},e);t=this._xss_sanitize(t);var a=this._makePrviewHtml(t),i=this.form.find("#cbba_preview_div");i.find("#cbba_preview_div2").html(a),i.show(),this.form.find("#cbba_inps_div").hide(),this.data=e}else this._err("テキストエリアが空です。")}},{key:"_getDataFromTextArea",value:function(e){var t=this.form.find("#cbba_ta").val(),a=this._makeADataFromTaText(t),i=this._filteringToTaInpFields();for(var n in a){var r=a[n],l={};for(var s in i){var o=i[s].field;null==r[s]?l[o]="":l[o]=r[s]}e.push(l)}return e}},{key:"_makeADataFromTaText",value:function(e){var t=[],a=e.split("\n");for(var i in a){var n=a[i];if(""!=n){var r=n.split("\t");t.push(r)}}return t}},{key:"_filteringToTaInpFields",value:function(){var e=this.inpFields,t=[];for(var a in e){var i=e[a];"textarea"==i.inp_type&&t.push(i)}return t}},{key:"_getDataFromSameApplys",value:function(e){var t=this._filteringInpFieldsByInpTypes(["text","date","select"]);for(var a in t){var i=t[a].field,n="",r=this.form.find("."+i);for(var l in r[0]&&(n=r.val()),e){e[l][i]=n}}return e}},{key:"_filteringInpFieldsByInpTypes",value:function(e){var t=this.inpFields,a=[];for(var i in t){var n=t[i];0<=e.indexOf(n.inp_type)&&a.push(n)}return a}},{key:"_makePrviewHtml",value:function(e){if(0==e.length)return"";var t=this._getTHeads(e[0]),a="<table class='tbl2'>";a+="<thead><tr>";var i=e[0];for(var n in i){a+="<th>"+t[n]+"</th>"}for(var r in a+="</tr></thead>",e){var l=e[r];for(var s in a+="<tr>",l)a+="<td>"+l[s]+"</td>";a+="</tr>"}return a+="</table>"}},{key:"_getTHeads",value:function(e){var t={},a=this.fieldData;for(var i in e){var n=i;for(var r in a){var l=a[r];if(i==l.field){n=l.wamei;break}}t[i]=n}return t}},{key:"_xss_sanitize",value:function(e){if("object"!=_typeof(e))return"string"==typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;"):e;for(var t in e)e[t]=this._xss_sanitize(e[t]);return e}},{key:"_bulkAdd",value:function(){this._anabledBulkAddBtn(!1);var e=this._getAddPosition(),t={add_position:this.param.add_position=e};this._ajax("cbba_get_sort_no",t,this._bulkAdd2)}},{key:"_bulkAdd2",value:function(e,t){var a=t.next_sort_no,i=e.param.add_position,n=e.data,r=a;for(var l in n){n[l].sort_no=r,1==i?r++:r--}var s={data:n};e._ajax("cbba_add_reg",s,e._bulkAdd3)}},{key:"_bulkAdd3",value:function(e,t){var a=t.newIds,i=e.data;for(var n in i){var r=i[n],l=a[n];r.id=l}var s=t.err_msg;""==s?location.reload(!0):e._err(s)}},{key:"_ajax",value:function(e,t,i){var n=this,a=this.param.ajax_url;t.action_code=e;var r=JSON.stringify(t);jQuery.ajax({type:"POST",url:a,data:"key1="+r,cache:!1,dataType:"text"}).done(function(t,e){var a=null;try{a=jQuery.parseJSON(t)}catch(e){return void n._err(t)}i(n,a)}).fail(function(e,t,a){n._err(e.responseText)})}},{key:"_anabledBulkAddBtn",value:function(e){null==e&&(e=!1),null==this.regBtn&&(this.regbtn=this.form.find("#cbba_reg_btn"));var t=this.regbtn;1==e?(t.val("一括追加"),t.prop("disabled",!1)):(t.val("追加中・・・"),t.prop("disabled",!0))}},{key:"_getAddPosition",value:function(){var e=this.form.find('input[name="cbba_sort_no"]:checked'),t=1;return e[0]&&(t=e.val()),t}},{key:"_err",value:function(e){null==this.errElm&&(this.errElm=this.form.find("#cbba_err")),this.errElm.html(e)}}]),t}(),CrudBasePasswordEdit=function(){function n(e,t,a){_classCallCheck(this,n),this.newInpForm=e,this.editForm=t,this.param=this._setParamIfEmpty(a);var i=[];i=this._getPwElmsFromNewInp(i,e,"new_inp"),i=this._getPwElmsFromNewInp(i,t,"edit"),i=this._createPwChgbtns(i),this._setClickEventToBtn(i),this.data=i}return _createClass(n,[{key:"_setParamIfEmpty",value:function(e){return null==e&&(e={}),e}},{key:"_getPwElmsFromNewInp",value:function(i,e,n){var t=e.find("input[name='password']");return t[0]&&t.each(function(e,t){var a={pwElm:jQuery(t),pw_index:e,form_type:n};i.push(a)}),i}},{key:"_createPwChgbtns",value:function(e){for(var t in e){var a=e[t],i=a.form_type,n=a.pw_index,r=a.pwElm,l='<input type="button" id="'.concat("cbpe_"+i+n,'" value="パスワード変更" data-form-type="').concat(i,'" data-pw-index="').concat(n,'" class="btn btn-warning btn-xs" />');r.after(l);var s=this._getBtnElm(i,n);a.btnElm=s}return e}},{key:"_getBtnElm",value:function(e,t){var a=null;"new_inp"==e&&(a=this.newInpForm),"copy"==e&&(a=this.newInpForm),"edit"==e&&(a=this.editForm);var i="cbpe_"+e+t;return a.find("#"+i)}},{key:"_setClickEventToBtn",value:function(e){var t=this;for(var a in e){e[a].btnElm.click(function(e){t.clickPwChgbtn(t,e.currentTarget)})}}},{key:"clickPwChgbtn",value:function(e,t){var a=(t=jQuery(t)).attr("data-form-type"),i=t.attr("data-pw-index"),n=this._getEntity(a,i);if(null!=n){var r=n.pwElm;r.val(""),r.show(),(t=n.btnElm).hide()}}},{key:"_getEntity",value:function(e,t){for(var a in this.data){var i=this.data[a];if(i.form_type==e&&i.pw_index==t)return i}return null}},{key:"showForm",value:function(e){0!=this.data.length&&("new_inp"==e?this._changeForNewInp(e):this._changeForEditAndCopy(e))}},{key:"_changeForNewInp",value:function(e){for(var t in this.data){var a=this.data[t];if(a.form_type==e)a.btnElm.hide(),a.pwElm.show()}}},{key:"_changeForEditAndCopy",value:function(e){for(var t in this.data){var a=this.data[t];a.btnElm.show(),a.pwElm.hide()}}}]),n}(),CrudBaseReact=function(){function t(e){_classCallCheck(this,t)}return _createClass(t,[{key:"_setParamIfEmpty",value:function(e){return null==e&&(e={}),null==e.flg&&(e.flg=0),e}},{key:"init",value:function(e,t){this.fields=e;var a=t.split(",");for(var i in a){var n=a[i];a[i]=n.trim()}this.hyoIds=a,console.log(this.fields),console.log(this.hyoIds)}},{key:"reactivatingOfRow",value:function(){console.log("test=Ａ")}}]),t}(),CrudBaseRowExchange=function(){function s(e,t,a){var i=this;_classCallCheck(this,s),null==t&&(t={});var n=e.param.tbl_slt;this.afterCallback=a,this.tbl=e.tbl;var r="#exchange_tr_form_"+n;t.form_slt=r;var l=this._getFormHtml(r);this.tbl.after(l),this.form=jQuery(r),this.param=t,this.form.find(".exchange_tr_form_close").click(function(){i.form.hide()}),this.form.find(".exchange_tr_btn").click(function(){i._exchageTrReb()}),jQuery(r+" input").keypress(function(e){13==e.which&&i._exchageTrReb()}),this.form.find(".exchange_tr_shift_up").click(function(){i._exchageTrShiftUp()}),this.form.find(".exchange_tr_shift_down").click(function(){i._exchageTrShiftDown()})}return _createClass(s,[{key:"showForm",value:function(e){var t=jQuery(e),a=t.parents("tr").index();a+=1,this.param.from_row_index=a;var i=this.form.find(".exchange_tr_sort_no"),n=i.val();this._empty(n)&&i.val(a),this._showForm(this.form,t)}},{key:"_exchageTrReb",value:function(){var e=this.param.from_row_index,t=this.form.find(".exchange_tr_sort_no").val();0!=this._checkRowIndex(t)&&e!=t&&this._exchageTr(e,t)}},{key:"_exchageTrShiftUp",value:function(){var e=this.param.from_row_index,t=e-1;t<=0||(this._exchageTr(e,t),this.param.from_row_index=t)}},{key:"_exchageTrShiftDown",value:function(){var e=this.param.from_row_index,t=e+1;this.tbl.children("tbody").children("tr").length<t||(this._exchageTr(e,t),this.param.from_row_index=t)}},{key:"_exchageTr",value:function(e,t){var a=this.tbl.find("tr").eq(e),i=this.tbl.find("tr").eq(t);t<e?jQuery(i).before(a):jQuery(i).after(a),this.afterCallback&&this.afterCallback({from_row_index:e,to_row_index:t})}},{key:"_checkRowIndex",value:function(e){return null!=e&&(!!e.match(/^[0-9]*$/)&&!(e<=0))}},{key:"_showForm",value:function(e,t,a){a||(a="auto"),e.show();var i=(t=jQuery(t)).offset(),n=i.left,r=i.top,l=jQuery(window).width(),s=e.outerWidth(),o=r+t.outerHeight(),u=0;switch(a){case"left":u=n-s;break;case"center":u=l/2-s/2;break;case"right":u=n;break;default:l<(u=n)+s&&(u=l-s)}u<0&&(u=0),e.offset({top:o,left:u})}},{key:"_getFormHtml",value:function(e){var t=this._sltToCode(e);return"<div id='"+t+"_rap'>\t<div id='"+t+"' class='panel panel-primary' style='display:none;width:170px;'>\t\t<div class='panel-heading'>\t\t\t\t\t\t<div style='display:inline-block;width:80%'>行入替</div>\t\t\t<div style='display:inline-block;width:15%'>\t\t\t\t<button type='button' class='exchange_tr_form_close btn btn-primary btn-sm'>\t\t\t\t\t<span class='glyphicon glyphicon-remove'></span>\t\t\t\t</button>\t\t\t</div>\t\t</div>\t\t<div class='panel-body' \">\t\t\t<button type='button' class='exchange_tr_shift_up btn btn-primary btn-sm'><span class='glyphicon glyphicon-arrow-up'></span></button>\t\t\t<button type='button' class='exchange_tr_shift_down btn btn-primary btn-sm'><span class='glyphicon glyphicon-arrow-down'></span></button>\t\t\t<div style='margin-top:20px'>\t\t\t\t<input class='exchange_tr_sort_no' type='number' style='width:60px' min='1' max='9999'  />\t\t\t\t<input type='button' value='行入替' class='exchange_tr_btn btn btn-warning btn-sm' />\t\t\t</div>\t\t</div>\t</div></div>"}},{key:"_sltToCode",value:function(e){var t=e,a=t.charAt(0);return"#"!=a&&"."!=a||(t=t.substr(1)),t}},{key:"_empty",value:function(e){return null==e||""==e||"0"==e||"object"==_typeof(e)&&0==Object.keys(e).length}}]),s}(),DatepickerWrap=function(){function t(e){_classCallCheck(this,t),this.param=this._setParamIfEmpty(e),1==e.ja_flg&&this.datepicker_ja(),this._datepickerApply(),this._datetimepickerApply(),this._ympickerApply()}return _createClass(t,[{key:"_setParamIfEmpty",value:function(e){return null==e&&(e={}),null==e.ja_flg&&(e.ja_flg=1),null==e.datetimepicker_f&&(e.datetimepicker_f=0),e}},{key:"_datepickerApply",value:function(){jQuery(".datepicker").each(function(e,t){jQuery(t).datepicker({dateFormat:"yy-mm-dd"})})}},{key:"_datetimepickerApply",value:function(){0!=this.param.datetimepicker_f&&jQuery(".datetimepicker").each(function(e,t){jQuery(t).datetimepicker({dateFormat:"Y-m-d H:i"})})}},{key:"_ympickerApply",value:function(){var a={closeText:"閉じる",prevText:"&#x3c;前",nextText:"次&#x3e;",currentText:"今日",monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dateFormat:"yy/mm",yearSuffix:"年",onSelect:function(e,t){}};jQuery(".ympicker").each(function(e,t){jQuery(t).ympicker(a)})}},{key:"tukishomatu",value:function(t,r,l){var e={closeText:"閉じる",prevText:"&#x3c;前",nextText:"次&#x3e;",currentText:"今日",monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dateFormat:"yy/mm",yearSuffix:"年",onSelect:function(e,t){var a=e+"/1";$("#"+r).val(a);var i=new Date(a),n=DateFormat(n=new Date(i.getFullYear(),i.getMonth()+1,0),"yyyy/mm/dd");$("#"+l).val(n)}};$("#"+t).ympicker(e),$("#"+t).blur(function(){var e=$("#"+t).val();""!=e&&null!=e||($("#"+r).val(""),$("#"+l).val(""))})}},{key:"datepicker_ja",value:function(){jQuery.datepicker.regional.ja={closeText:"閉じる",prevText:"<前",nextText:"次>",currentText:"今日",monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayNames:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],dayNamesShort:["日","月","火","水","木","金","土"],dayNamesMin:["日","月","火","水","木","金","土"],weekHeader:"週",dateFormat:"yy/mm/dd",firstDay:0,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},jQuery.datepicker.setDefaults(jQuery.datepicker.regional.ja)}}]),t}();function DateFormat(e,t){var a,i,n=t,r=new Array("日","月","火","水","木","金","土");return a="yyyy",-1<n.indexOf(a)&&(i=e.getFullYear(),n=n.replace(/yyyy/,i)),a="mm",-1<n.indexOf(a)&&(i=PadZero(e.getMonth()+1,2),n=n.replace(/mm/,i)),a="ddd",-1<n.indexOf(a)&&(i=r[e.getDay()],n=n.replace(/ddd/,i)),a="dd",-1<n.indexOf(a)&&(i=PadZero(e.getDate(),2),n=n.replace(/dd/,i)),a="hh",-1<n.indexOf(a)&&(i=PadZero(e.getHours(),2),n=n.replace(/hh/,i)),a="ii",-1<n.indexOf(a)&&(i=PadZero(e.getMinutes(),2),n=n.replace(/ii/,i)),a="ss",-1<n.indexOf(a)&&(i=PadZero(e.getSeconds(),2),n=n.replace(/ss/,i)),a="fff",-1<n.indexOf(a)&&(i=PadZero(e.getMilliseconds(),3),n=n.replace(/fff/,i)),n}function DateParse(e,t){var a,i,n="1990",r="01",l="01",s="00",o="00",u="00",c="000";return a="yyyy",-1<(i=t.indexOf(a))&&(n=e.substr(i,a.length)),a="MM",-1<(i=t.indexOf(a))&&(r=parseInt(e.substr(i,a.length),10)-1),a="dd",-1<(i=t.indexOf(a))&&(l=e.substr(i,a.length)),a="HH",-1<(i=t.indexOf(a))&&(s=e.substr(i,a.length)),a="mm",-1<(i=t.indexOf(a))&&(o=e.substr(i,a.length)),a="ss",-1<(i=t.indexOf(a))&&(u=e.substr(i,a.length)),a="fff",-1<(i=t.indexOf(a))&&(c=e.substr(i,a.length)),new Date(n,r,l,s,o,u,c)}function PadZero(e,t){return new Array(t-(""+e).length+1).join("0")+e}var FileUploadK=function(){function t(e){_classCallCheck(this,t),this.active_fue_id,this.box={},this.mimeMap=this._getMimeMapping(),this.param=this._setParamIfEmpty(e),this.unit=jQuery(this.param.unit_slt),this.cbAsynsEnd}return _createClass(t,[{key:"_setParamIfEmpty",value:function(e){null==e&&(e={}),null==e.ajax_url&&(e.ajax_url=null),null==e.style_flg&&(e.style_flg=1),null==e.unit_slt&&(e.unit_slt="body"),null==e.err_slt&&(e.err_slt="#err"),null==e.fuk_msg_text&&(e.fuk_msg_text=""),null==e.valid_mime_flg&&(e.valid_mime_flg=0),null==e.img_width&&(e.img_width=null),null==e.img_height&&(e.img_height=null),null==e.adf&&(e.adf={fn_flg:1,size_flg:1,mime_flg:1,modified_flg:1});var t=null;return null!=e.valid_ext&&(t=e.valid_ext),e.validData=this._createValidData(t),e}},{key:"addEvent",value:function(a,i){var n=this;null==i&&(i={});var e=this._getElement(a,"label");e.attr("data-fue-id",a);var t=this._setToBox(a,this.box,i);this._addRelatedElements(e,a,t),this._applyStyle(a),e[0].addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;n.box[a].files=t,n._preview(a,"files",i)},!1),e[0].addEventListener("dragover",function(e){e.preventDefault()},!1),this._getElement(a,"fue").change(function(e){var t=e.target.files;null!=t&&0!=t.length&&(n.box[a].files=t,n._preview(a,"files",i))}),this._getElement(a,"clear_btn").click(function(e){n._clearBtnClick(e)})}},{key:"setFilePaths",value:function(e,t,a){var i=this;if(null==a&&(a={}),this._clearBtnAction(e),null!=t&&""!=t&&0!=t){"string"==typeof t&&(t=[t]),this._getElement(e,"fuk_msg").html("Now Loading ..");var n=[];for(var r in a.pacb=function(){i.box[e].bData=n,i._preview(e,"blob",a)},this._cbAsynsEndInit(t.length,a),t){var l=t[r];this._preloadByXhr(l,n)}}}},{key:"_preloadByXhr",value:function(e,t){var a=this,i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(e){a._xhrOnload(e,i,t)},i.send()}},{key:"_xhrOnload",value:function(e,t,a){var i=e.target.response,n=e.target.responseURL,r=this._stringRightRev(n,"/"),l=t.getResponseHeader("Content-Type"),s=t.getResponseHeader("Content-Length"),o=(t.getResponseHeader("server"),{fn:r,mime_type:l,size:s,modified:t.getResponseHeader("Last-Modified"),blob:i});a.push(o),this._cbAsynsEndAction("exe1")}},{key:"_addRelatedElements",value:function(e,t,a){var i="";i+="<span class='fuk_msg'>"+a[t].fuk_msg_text+"</span>",i+="<span class='fuk_preview' style='display:inline-block'></span>",i+="<div class='fuk_clear_btn_w'><input type='button' value='Clear' class='btn btn-default btn-xs fuk_clear_btn' data-fue-id='"+t+"' /></div>",e.append(i)}},{key:"_applyStyle",value:function(e){this.param.style_flg&&this._getElement(e,"label").addClass("fuk")}},{key:"_preview",value:function(e,t,a){this._getElement(e,"fuk_msg").html("Now Loading ..."),this.active_fue_id=e;var i=null,n=null,r=[];if("files"==t){i=this.box[e].files;r=this._getFileDataFromFiles(i)}else{if("blob"!=t)throw new Error("Unknown 'bin_type'");n=this.box[e].bData,r=this._getFileDataFromBData(n)}if(!this._checkFnsEmpty(r)){this._getElement(e,"label").css({width:"auto",height:"auto"}),this._getElement(e,"clear_btn_w").show(),r=this._validCheck(e,r),this.box[e].fileData=r;var l="";for(var s in r){var o=r[s];l+=this._makeFileUnitHtml(e,o,a)}var u=this._getElement(e,"preview");u[0]&&u.html(l);var c={};if(u.children("div").each(function(e,t){var a=(t=jQuery(t)).find(".fuk_rp");a[0]?c[e]=a:c[e]=null}),r=this._filteringFileData(r,c),"files"==t){for(var s in this._cbAsynsEndInit(r.length,a),r){var f=i[d=(o=r[s]).index];this._setupRender(f,c,d)}this._cbAsynsEndAction("exe2")}else if("blob"==t){for(var s in r){var d,h=n[d=(o=r[s]).index].blob,_=window.URL.createObjectURL(h);c[d].attr("src",_)}this._cbAsynsEndAction("exe2")}}}},{key:"_checkFnsEmpty",value:function(e){for(var t in e){if(e[t].fn)return!1}return!0}},{key:"_filteringFileData",value:function(e,t){var a=[];for(var i in e)if(null!=t[i]){var n=e[i];1!=n.err_flg&&null!=n.size&&0!=n.size&&(n.index=i,a.push(n))}return a}},{key:"_setupRender",value:function(e,t,a){var i=this,n=new FileReader;n.readAsDataURL(e),n.onload=function(e){t[a].attr("src",n.result),i._cbAsynsEndAction("exe1")}}},{key:"_getFileDataFromFiles",value:function(e){var t=[];for(var a in e){var i=e[a];if(null!=i.size){var n={},r=i.type,l="";null!=(n.mime=r)&&(0<=r.indexOf("image")&&(l="image"),0<=r.indexOf("audio")&&(l="audio")),n.file_type=l;var s="";null!=i.name&&(s=i.name),n.fn=s,n.size=i.size;var o=0;null!=i.size&&(o=i.size),isNaN(o)||(o=this._convSizeUnit(o)),n.size_str=o;var u="";null!=i.lastModifiedDate&&(u=i.lastModifiedDate.toLocaleString()),n.modified=u,t.push(n)}}return t}},{key:"_getFileDataFromBData",value:function(e){var t=[];for(var a in e){var i=e[a];if(null!=i.size&&0!=i){var n={};n.mime=i.mime_type;var r="";null!=n.mime&&(0<=n.mime.indexOf("image")&&(r="image"),0<=n.mime.indexOf("audio")&&(r="audio")),n.file_type=r,n.fn=i.fn,n.size=i.size;var l=0;null!=i.size&&(l=i.size),isNaN(l)||(l=this._convSizeUnit(l)),n.size_str=l;var s="";null!=i.modified&&(s=new Date(s).toLocaleString()),n.modified=s,t.push(n)}}return t}},{key:"_validCheck",value:function(e,t){var a=this.box[e].validData.validExts,i=!0;for(var n in null!=a&&0!=a||(i=!1),t){var r=t[n];if(0!=i){var l=r.fn;if(""!=l&&null!=l){var s=this._getExtension(r.fn);-1!=a.indexOf(s)?(r.err_flg=!1,r=this._validCheckMime(e,r)):(r.err_flg=!0,r.err_msg=l+"の拡張子は対象外です。")}else r.err_flg=!0,r.err_msg="ファイル名が空です。",r.fn_empty=!0}else r.err_flg=!1}return t}},{key:"_getExtension",value:function(e){if(null==e)return"";var t=e.split("."),a=t[t.length-1];return a=a.toLowerCase()}},{key:"_validCheckMime",value:function(e,t){if(0==this.param.valid_mime_flg)return t;if(1==t.err_flg)return t;var a=this.box[e].validData.validMimes,i=t.mime;return-1==a.indexOf(i)?(t.err_flg=!0,t.err_msg=t.fn+"のMIME("+i+")は対象外です。"):t.err_flg=!1,t}},{key:"_makeFileUnitHtml",value:function(e,t,a){var i="";if(1==t.err_flg)return i="<div class='fuk_file_unit' >"+(i="<div class='fuk_err_msg'>"+t.err_msg+"</div>")+"</div>";var n=this._getImgSize(e,a),r=n.width,l=n.height;"image"==t.file_type?i+="<img src='' class='fuk_rp' style='width:"+r+"px;height:"+l+"px;' />":"audio"==t.file_type&&(i+="<audio src='' class='fuk_rp' controls />");var s=this.param.adf,o=[{label:"ファイル名",val:t.fn,flg:s.fn_flg},{label:"サイズ",val:t.size_str,flg:s.size_flg},{label:"MIME",val:t.mime,flg:s.mime_flg},{label:"更新日",val:t.modified,flg:s.modified_flg}];for(var u in o){var c=o[u];1==c.flg&&(i+="<div><label class='fuk_param_label'>"+c.label+"</label><val class='fuk_param_val'>"+c.val+"</val></div>")}return i="<div class='fuk_file_unit' >"+i+"</div>"}},{key:"_getImgSize",value:function(e,t){return{width:t.img_width?t.img_width:this.param.img_width?this.param.img_width:this.box[e].label_width?this.box[e].label_width:160,height:t.img_height?t.img_height:this.param.img_height?this.param.img_height:this.box[e].label_height?this.box[e].label_height:160}}},{key:"_clearBtnClick",value:function(e){var t=jQuery(e.currentTarget).attr("data-fue-id");this._clearBtnAction(t)}},{key:"_clearBtnAction",value:function(e){this._getElement(e,"clear_btn_w").hide(),this._getElement(e,"fue").val("");var t=this._getElement(e,"fuk_msg"),a=this.box[e].fuk_msg_text;t.html(a),t.show(),this._getElement(e,"preview").html("");var i=this.box[e].label_width,n=this.box[e].label_height,r=this._getElement(e,"label");r.width(i),r.height(n),this.box[e].fileData=[]}},{key:"_cbAsynsEndInit",value:function(e,t){var a=function(){};null!=t.pacb&&(a=t.pacb);var i={};null!=t.pacb_param&&(i=t.pacb_param),this.cbAsynsEndData={index:0,count:e,callback:a,cbParam:i}}},{key:"_cbAsynsEndAction",value:function(e){switch(e){case"exe1":(t=this.cbAsynsEndData).index==t.count-1?null!=t.callback&&(t.callback(this.active_fue_id,this.box,t.cbParam),this._endPreview()):t.index++;break;case"exe2":var t;0==(t=this.cbAsynsEndData).count&&null!=t.callback&&(t.callback(this.active_fue_id,this.box,t.cbParam),this._endPreview())}}},{key:"_endPreview",value:function(){this._getElement(this.active_fue_id,"fuk_msg").hide()}},{key:"uploadByAjax",value:function(e,t,a){var n=this,i=this.param,r=new FormData,l=0;for(var s in this.box){var o=this.box[s].files,u=this.box[s].fileData;for(var c in u){0==u[c].err_flg&&(r.append(l,o[c]),l++)}}t=this._escapeForAjax(t);var f=JSON.stringify(t);r.append("key1",f);var d=null;i.prog_slt&&(d=this.unit.find(i.prog_slt)),jQuery.ajax({type:"POST",url:i.ajax_url,data:r,cache:!1,dataType:"text",processData:!1,contentType:!1,xhr:function(){var e=jQuery.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(e){if(d){var t=parseInt(e.loaded/e.total*1e4)/100;d.val(t)}},!1),e}}).done(function(t,e){var a;try{a=jQuery.parseJSON(t)}catch(e){return void jQuery(n.param.err_slt).html(t)}resOutput(a)}).fail(function(e,t,a){var i=e.responseText;console.log(i),jQuery(n.param.err_slt).html(i),alert(t)})}},{key:"getFileParams",value:function(){var e=[];for(var t in this.box){var a=this.box[t].files,i={};for(var n in a){var r=a[n];null!=r.size&&(i.fu_id=t,i.name=r.name,i.size=r.size,i.mime=r.type,i.modified=r.lastModifiedDate.toLocaleString(),e.push(i))}}return e}},{key:"_getElement",value:function(e,t){var a=this.box;if(null==a[e]&&(a[e]={}),"fue"==t){var i=null;return a[e].fue?i=a[e].fue:(i=this.unit.find("#"+e),a[e].fue=i),i}if("label"==t){i=null;if(a[e].label)i=a[e].label;else{var n=this._getElement(e,"fue");if(null==n)return null;i=n.parents("label"),a[e].label=i}return i}if("fuk_msg"==t){i=null;if(a[e].fuk_msg)i=a[e].fuk_msg;else{if(null==(r=this._getElement(e,"label")))return null;i=r.find(".fuk_msg"),a[e].fuk_msg=i}return i}if("preview"==t){i=null;if(a[e].preview)i=a[e].preview;else{if(null==(r=this._getElement(e,"label")))return null;i=r.find(".fuk_preview"),a[e].preview=i}return i}if("clear_btn"==t){i=null;if(a[e].clear_btn)i=a[e].clear_btn;else{if(null==(r=this._getElement(e,"label")))return null;i=r.find(".fuk_clear_btn"),a[e].clear_btn=i}return i}if("clear_btn_w"!=t)return null;i=null;if(a[e].clear_btn_w)i=a[e].clear_btn_w;else{var r;if(null==(r=this._getElement(e,"label")))return null;i=r.find(".fuk_clear_btn_w"),a[e].clear_btn_w=i}return i}},{key:"_setToBox",value:function(e,t,a){null==a&&(a={});var i={};t[e]&&(i=t[e]);var n=this._getElement(e,"label");i.label_width=n.width(),i.label_height=n.height();var r="";if(this.param.fuk_msg_text)r=this.param.fuk_msg_text;else{var l=this._getElement(e,"fue").attr("title");r=l||"File Upload"}return i.fuk_msg_text=r,null==a.valid_ext?i.validData=this.param.validData:i.validData=this._createValidData(a.valid_ext),t[e]=i,t}},{key:"_convSizeUnit",value:function(e,t){null==t&&(t=1);return e<1e3?e+"Byte":e<Math.pow(10,6)?(e=Math.round(e*Math.pow(10,t-3))/Math.pow(10,t))+"KB":e<Math.pow(10,9)?(e=Math.round(e*Math.pow(10,t-6))/Math.pow(10,t))+"MB":e<Math.pow(10,12)?(e=Math.round(e*Math.pow(10,t-9))/Math.pow(10,t))+"GB":(e=Math.round(e*Math.pow(10,t-12))/Math.pow(10,t))+"TB"}},{key:"_createValidData",value:function(e){var t={validExts:[],validMimes:[]};if(null==e||""==e)return t;var a=[];for(var i in a=Array.isArray(e)?e:"image"==e?["jpg","jpeg","png","gif","bpg"]:"audio"==e?["mp3","wav"]:e.split(","))a[i]=a[i].trim();a=this._array_unique(a);var n=this._getValidMimes(a);return t.validExts=a,t.validMimes=n,t}},{key:"_array_unique",value:function(e){return e.filter(function(e,t,a){return a.indexOf(e)===t})}},{key:"_getValidMimes",value:function(e){var t=this.mimeMap,a=[];for(var i in e){var n=e[i],r="";null!=t[n]&&(r=t[n]),a.push(r)}return a}},{key:"getFileNames",value:function(e){var t=[];if(null==e)for(var e in this.box){var a=this.box[e].fileData;for(var i in a){var n=a[i];t.push(n.fn)}}else{a=this.box[e].fileData;for(var i in a){n=a[i];t.push(n.fn)}}return t}},{key:"_getMimeMapping",value:function(){var e={aac:"audio/aac",abw:"application/x-abiword",arc:"application/octet-stream",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bpg:"image/bpg",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",es:"application/ecmascript",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/x-icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",mid:"audio/midi audio/x-midi",midi:"audio/midi audio/x-midi",mp3:"audio/mp3",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",otf:"font/otf",png:"image/png",pdf:"application/pdf",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/x-rar-compressed",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"application/typescript",ttf:"font/ttf",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"};return e}},{key:"_escapeForAjax",value:function(e){if("string"==typeof e)return-1!=e.indexOf("&")?(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),encodeURIComponent(e)):e;if("object"!=_typeof(e))return e;for(var t in e)e[t]=this._escapeForAjax(e[t]);return e}},{key:"_stringRightRev",value:function(e,t){if(null==e||""==e)return e;var a=e.lastIndexOf(t);return e.substring(a+t.length,e.length)}}]),t}(),ImportFu=function(a){this.param=a,this.fu_wrap,this.files;var d=this;function h(e){var t,s=d.param;t=d.param,d.fu_wrap.find("#"+t.preview_xid).hide(),d.fu_wrap.find(".loding_gif").show();var a=e[0];if(null!=a){var i=new FileReader;i.readAsDataURL(a),i.onload=function(e){var t,a,i,n=function(){var e=d.param.fw,t=d.param.ajax_url;{if(""==e&&""!=t)return t;if(""==e&&""==t)throw new Error("Empty ajax_url !");if("wp"==e&&""!=t)return t;if("wp"==e&&""==t)return jQuery("#admin-ajax-url").val()}}(),r=s.fu_slt,l=new FormData;l.append("upload_file",jQuery(r).prop("files")[0]),"wp"==s.fw&&(t=l,a=s.wp_ajax_action,i=jQuery("#nonce").val(),t.append("action",a),t.append("nonce",i),l=t),jQuery.ajax({type:"POST",url:n,data:l,cache:!1,dataType:"text",processData:!1,contentType:!1}).done(function(t,e){var a,i;try{v((a=JSON.parse(t)).err_msg)?((i=jQuery("#"+d.param.suc_msg_xid)).show(),0!=d.param.suc_toggle_sec&&i.fadeOut(d.param.suc_toggle_sec),v(s.success_callback)||s.success_callback(a)):jQuery("#"+s.err_xid).html(a.err_msg),o(),_()}catch(e){throw console.log(t),jQuery("#"+s.err_xid).html(t),o(),_(),e}}).fail(function(e,t,a){console.log(e);var i=e.responseText;console.log(i),jQuery("#"+s.err_xid).html(i),alert(t),o()})}}}function _(){d.files=null,d.fu_wrap.find(".imp_fu_caption").show();var e=d.fu_wrap.find("#"+a.preview_xid);e.find(".imp_fu_pre_fn").html(""),e.hide();var t=d.param.fu_slt;jQuery(t).val("")}function n(e){var t=d.param,a=d.fu_wrap.find("#"+t.preview_xid);a.show();var i=a.find(".imp_fu_pre_fn"),n=e[0].name;i.html(n),d.fu_wrap.find(".imp_fu_caption").hide(),d.files=e,jQuery("#"+d.param.suc_msg_xid).hide()}function o(){d.fu_wrap.find(".loding_gif").hide()}function p(e){var t=e,a=t.charAt(0);return"#"!=a&&"."!=a||(t=t.substr(1)),t}function v(e){return null==e||""==e||"0"==e||"object"==_typeof(e)&&0==Object.keys(e).length}this.constract=function(){var a,i,e;this.param=function(e){null==e&&(e={});if(null==e.fu_slt)throw new Error("The fu_slt in param is empty!");var t=p(e.fu_slt);null==e.ajax_url&&(e.ajax_url="");null==e.preview_flg&&(e.preview_flg=1);null==e.caption&&(e.caption="File upload");null==e.caption_color&&(e.caption_color="#a698c9");null==e.caption_color2&&(e.caption_color2="#FFFFFF");null==e.back_color&&(e.back_color="#e3dfee");null==e.caption_font_size&&(e.caption_font_size="40px");null==e.backimg_fp&&(e.backimg_fp="");null==e.wrap_xid&&(e.wrap_xid=t+"_wrap");null==e.fw&&(e.fw="");if(null==e.wp_ajax_action){if("wp"==e.fw)throw Error("The wp_ajax_action in param is empty! (WordPress only)");e.wp_ajax_action=""}null==e.success_callback&&(e.success_callback=null);null==e.suc_msg_xid&&(e.suc_msg_xid=t+"_suc_msg");null==e.suc_msg&&(e.suc_msg="読込が終わりました。");null==e.suc_toggle_sec&&(e.suc_toggle_sec=3e3);null==e.fuWrapCss&&(e.fuWrapCss={"background-color":e.back_color,"border-radius":"5px",display:"inline-block"});null==e.label_xid&&(e.label_xid=t+"_label");null==e.caption_xid&&(e.caption_xid=t+"_caption");null==e.preview_xid&&(e.preview_xid=t+"_preview");if(null==e.captionCss){var a=e.caption_color,i=e.caption_color2,n=e.caption_font_size;e.captionCss={padding:"0px 20px 0px 20px",color:i,"font-size":n,"font-weight":"bold","text-shadow":"2px 2px 1px "+a+",-2px 2px 1px "+a+",2px -2px 1px "+a+",-2px -2px 1px "+a}}null==e.err_xid&&(e.err_xid=t+"_err");return e}(this.param),function(e){var t=e.fu_slt,a=jQuery(t),i=p(t);a.hide(),a.wrap("<div id='"+e.wrap_xid+"'  ><label id = '"+e.label_xid+"' for='"+i+"' ></label></div>");var n=jQuery("#"+e.wrap_xid);n.css(e.fuWrapCss);var r=n.find("#"+e.label_xid),l="<div id='"+e.caption_xid+"' class='imp_fu_caption'>"+e.caption+"</div>";if(r.append(l),n.find("#"+e.caption_xid).css(e.captionCss),!v(e.backimg_fp)){var s="<img src='"+e.backimg_fp+"' />";n.append(s)}var o="<div id='"+e.preview_xid+"' style='display:none;margin:0px 20px 20px 20px;'>\t<div id='"+e.pre_fn_xid+"' class='imp_fu_pre_fn'></div>\t<div class='imp_fu_pre_btns' style='margin-top:10px'>\t\t<input type='button' class='imp_fu_pre_exe_btn btn btn-success btn' value='アップロード' />\t\t<input type='button' class='imp_fu_pre_cancel_btn btn btn-default btn' value='キャンセル' />\t</div></div>";n.append(o);var u="<div class='loding_gif' style='display:none;padding:20px;'>\t<img src='data:image/gif;base64,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' /> 読み込み中・・・</div>";n.append(u),n.find(".imp_fu_pre_exe_btn").click(function(e){h(d.files)}),n.find(".imp_fu_pre_cancel_btn").click(function(e){_()});var c="<div id='"+e.suc_msg_xid+"' class='text-success' style='display:none'>"+e.suc_msg+"</div>";n.after(c);var f="<div id='"+e.err_xid+"' class='text-danger' ></div>";n.after(f),d.fu_wrap=n}(this.param),a=this.param,jQuery(a.fu_slt).change(function(e){var t=e.target.files;a.preview_flg?n(t):h(t)}),i=this.param,(e=jQuery("#"+i.wrap_xid))[0].addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;i.preview_flg?n(t):h(t)},!1),e[0].addEventListener("dragover",function(e){e.preventDefault()},!1)},this.constract()};function errShowDetail(){if($("#err")[0]&&$("#detail_div")[0]){var e=$("#err").html();""!=(e=e.trim())&&$("#detail_div").show()}}function resetKjs(e){null==e&&(e=[]);var t=$("#def_kjs_json").val(),a=$.parseJSON(t);for(var i in a)e.indexOf(i)<0&&$("#"+i).val(a[i])}function moveClmSorterBase(e){var t=csh.getCshAry(),a=null;a=0==t.length?$("#csh_json").val():JSON.stringify(t);var i=encodeURIComponent(a),n=$("#webroot").val()+"clm_sorter?p="+e+"&csh_u="+i;location.href=n}function loadSvg(e,t){$(t+":empty").load(e,function(){})}function toggleSvg(e,t){loadSvg(e,t);var a=$(t);"none"==a.css("display")?a.show():a.hide()}function linkByRowdata(e,t,a){null==a&&(a="id");var i=(e=$(e)).parents("tr").find("."+a).text();t=t.replace("%0",i),location.href=t}$(function(){errShowDetail()}),$(function(){(new LiviPage).execution({width:"auto"})});var LiviPage=function(){this.execution=function(e){$(document.body).append("<div id='livipage_tooltip'></div>");var s={"z-index":2,"background-color":"white",position:"absolute",border:"solid 2px #ccb1bf",padding:"5px",width:"280px",height:"460px","overflow-y":"auto"};null!=e&&$.extend(s,e),$(document).click(function(){$("#livipage_tooltip").hide()}),$("#livipage_tooltip").click(function(e){e.stopPropagation()}),$(".livipage").click(function(){var e=$(this).attr("href"),t=$(this).offset(),a=t.left,i=t.top,n=($(e).width(),$(e).height(),$(e).html());n="<a href='"+e+"'>"+$(this).html()+"</a><br>"+n,$("#livipage_tooltip").show(),$("#livipage_tooltip").css(s),$("#livipage_tooltip").html(n);var r=a,l=i+16;return $("#livipage_tooltip").offset({top:l,left:r}),!1})}},ProcessWithMultiSelection=function(e){this.param=e;var s=this;function o(e,t){var a=e.find("[name='"+t+"']");return a[0]||(a=e.find("."+t)),a}this.constract=function(){this.param=function(e){null==e&&(e={});null==e.tbl_slt&&(e.tbl_slt="tbl1");null==e.cb_slt&&(e.cb_slt="pwms");null==e.id_slt&&(e.id_slt="id");if(null!=e.ajax_url)return e;throw new Error("'ajax_url' is nothing")}(this.param)},this.action=function(e){var l,t,a=(l=[],t=s.param.tbl_slt+" tbody tr",$(t).each(function(){var e,t,a,i,n=$(this);if(o(n,s.param.cb_slt).prop("checked")){var r=(e=n,t=s.param.id_slt,a=void 0,(i=e.find("[name='"+t+"']"))[0]?a=i.val():(i=e.find("."+t))[0]&&(a=i.text()),a);l.push(r)}}),l);if(0!=a.length){if("11"==e)if(!confirm("チェックした行を削除してもよろしいですか？"))return;var i={ids:a,kind_no:e},n=JSON.stringify(i);$.ajax({type:"POST",url:s.param.ajax_url,data:"key1="+n,cache:!1,dataType:"text",success:function(e,t){"success"==e?location.reload(!0):$("#err").html(e)},error:function(e,t,a){$("#err").html(e.responseText),alert(t)}})}},this.switchAllSelection=function(e){var t=$(e).prop("checked"),a=s.param.tbl_slt+" tbody tr";$(a).each(function(){o($(this),s.param.cb_slt).prop("checked",t)})},this.constract()};